(this["webpackJsonptimberborn-save-editor"]=this["webpackJsonptimberborn-save-editor"]||[]).push([[0],{11:function(e,t,n){},12:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"DownloadPlugin",(function(){return j})),n.d(a,"MapSizePlugin",(function(){return O}));var c=n(1),r=n.n(c),i=n(6),s=n.n(i),l=(n(11),n(2)),o=(n(12),n(0));function u(e){var t=e.onSaveLoaded,n=Object(c.useState)(),a=Object(l.a)(n,2),r=a[0],i=a[1],s=Object(c.useCallback)((function(e){try{var n,a=null===(n=e.target)||void 0===n?void 0:n.files,c=null===a||void 0===a?void 0:a.item(0);if(!c)throw new Error("Expected file to be uploaded, found none");var s=new FileReader;s.onload=function(e){try{var n=JSON.parse(s.result);t(n)}catch(r){throw i(r),r}},s.readAsText(c,"utf-8")}catch(r){throw i(r),r}}),[t,i]);return Object(o.jsx)("div",{className:"container my-4",children:Object(o.jsx)("div",{className:"row",children:Object(o.jsx)("div",{className:"col-md-6 offset-md-3",children:Object(o.jsx)("label",{className:"card",children:Object(o.jsxs)("div",{className:"card-body",children:[Object(o.jsx)("h1",{className:"card-title",children:"Timberborn Save Editor"}),Object(o.jsxs)("div",{className:"mb-3",children:[Object(o.jsx)("span",{className:"form-label",children:"Upload your Demo save to start"}),Object(o.jsx)("input",{type:"file",name:"save",accept:".json",onInput:s,className:"form-control"}),r?Object(o.jsx)("small",{className:"form-text",children:"#{error}"}):Object(o.jsxs)("small",{className:"form-text",children:["Default directory: ",Object(o.jsx)("code",{children:"%USERPROFILE%\\Documents\\Timberborn\\DemoSaves\\"})]})]})]})})})})})}function b(){return Object(o.jsx)("nav",{className:"navbar navbar-light bg-light",children:Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("span",{className:"navbar-brand",children:"Timberborn Save Editor"})})})}var d=Object(c.createContext)(void 0),j={id:"DownloadPlugin",name:"Download",group:"General",enabled:!0,read:function(e){return e},write:function(e,t){throw new Error("Not implemented")},Preview:function(e){e.saveData;return null},Editor:function(e){var t=e.initialData,n=e.onClose,a=Object(c.useMemo)((function(){return new Blob([JSON.stringify(t,null,2)],{type:"application/json"})}),[t]),r=URL.createObjectURL(a),i=new Date,s="".concat(i.toISOString().substr(0,10)," ").concat(i.getHours(),"h").concat(i.getMinutes(),"m, Day ").concat(t.Singletons.CycleService.Cycle,"-").concat(t.Singletons.CycleService.CycleDay," MODDED.json");return Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("div",{className:"card my-4",children:Object(o.jsxs)("div",{className:"card-body",children:[Object(o.jsx)("h1",{className:"card-title",children:"Download"}),Object(o.jsxs)("div",{className:"d-flex",children:[Object(o.jsx)("a",{href:r,download:s,className:"btn btn-primary",onClick:function(){return n()},children:"Download"}),Object(o.jsx)("button",{type:"button",className:"btn btn-light ms-auto",onClick:n,children:"Close"})]})]})})})}},m=n(3),O={id:"MapSizePlugin",name:"Map size",group:"General",enabled:!0,read:function(e){return{x:e.Singletons.MapSize.Size.X,y:e.Singletons.MapSize.Size.Y}},write:function(e,t){return e.Singletons.MapSize.Size.X=t.x,e.Singletons.MapSize.Size.Y=t.y,e},Preview:function(e){var t=e.saveData,n=t.Singletons.MapSize.Size.X,a=t.Singletons.MapSize.Size.Y;return Object(o.jsxs)("span",{children:[Object(o.jsx)("strong",{children:n})," \xd7 ",Object(o.jsx)("strong",{children:a})]})},Editor:function(e){var t=e.initialData,n=e.onClose,a=e.onSubmit,r=Object(c.useState)(t),i=Object(l.a)(r,2),s=i[0],u=i[1];return Object(o.jsx)("form",{onSubmit:function(e){e.preventDefault(),a(s)},children:Object(o.jsx)("div",{className:"container",children:Object(o.jsx)("div",{className:"card my-4",children:Object(o.jsxs)("div",{className:"card-body",children:[Object(o.jsx)("h1",{className:"card-title",children:"Map size editor"}),Object(o.jsx)("p",{children:"This is just a demo editor - changing this will likely break something."}),Object(o.jsxs)("div",{className:"mb-3",children:[Object(o.jsx)("label",{htmlFor:"x",className:"form-label",children:"X"}),Object(o.jsx)("input",{id:"x",type:"number",className:"form-control",value:s.x,onInput:function(e){return u(Object(m.a)(Object(m.a)({},s),{},{x:parseInt(e.target.value,10)}))}})]}),Object(o.jsxs)("div",{className:"mb-3",children:[Object(o.jsx)("label",{htmlFor:"y",className:"form-label",children:"Y"}),Object(o.jsx)("input",{id:"y",type:"number",className:"form-control",value:s.y,onInput:function(e){return u(Object(m.a)(Object(m.a)({},s),{},{y:parseInt(e.target.value,10)}))}})]}),Object(o.jsxs)("div",{className:"d-flex",children:[Object(o.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"}),Object(o.jsx)("button",{type:"button",className:"btn btn-light ms-auto",onClick:n,children:"Discard changes"})]})]})})})})}},v=Object.values(a).filter((function(e){return e&&"object"===typeof e})),h=n(5);function f(e){var t=e.saveData,n=e.onSelectPlugin,a=Object(c.useMemo)((function(){return Object(h.toPairs)(Object(h.groupBy)(v.filter((function(e){return"function"===typeof e.enabled?e.enabled(t):e.enabled})),"group"))}),[t]);return Object(o.jsx)("div",{className:"container",children:a.map((function(e){var a=Object(l.a)(e,2),c=a[0],r=a[1];return Object(o.jsxs)("div",{className:"my-2",children:[Object(o.jsx)("h2",{className:"ps-2",children:c}),Object(o.jsx)("div",{className:"list-group my-2",children:r.map((function(e){var a=e.id,c=e.name,r=e.Preview;return Object(o.jsxs)("button",{type:"button",onClick:function(e){e.preventDefault(),n(a)},className:"list-group-item list-group-item-action",children:[Object(o.jsx)("div",{className:"fw-bold",children:c}),Object(o.jsx)("div",{children:Object(o.jsx)(r,{saveData:t})})]},a)}))})]},c)}))})}function x(e){return JSON.parse(JSON.stringify(e))}function p(e){var t=e.saveData,n=e.pluginId,a=e.onClose,r=e.onSubmit,i=Object(c.useMemo)((function(){return v.find((function(e){return e.id===n}))}),[n]),s=i.Editor,l=i.read,u=i.write,b=Object(c.useMemo)((function(){return l(x(t))}),[l,t]),d=Object(c.useCallback)((function(e){r(x(u(t,e)))}),[u,t,r]);return Object(o.jsx)(s,{initialData:b,onClose:a,onSubmit:d})}function S(e){var t=e.saveData,n=e.onSubmit,a=Object(c.useState)(null),r=Object(l.a)(a,2),i=r[0],s=r[1],u=Object(c.useCallback)((function(e){n(e),s(null)}),[n]);return null===i?Object(o.jsx)(f,{saveData:t,onSelectPlugin:s}):Object(o.jsx)(p,{saveData:t,pluginId:i,onClose:function(){return s(null)},onSubmit:u})}var g=function(){var e=Object(c.useState)(null),t=Object(l.a)(e,2),n=t[0],a=t[1];return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(b,{}),null===n?Object(o.jsx)(u,{onSaveLoaded:a}):Object(o.jsx)(d.Provider,{value:{saveData:n},children:Object(o.jsx)(S,{saveData:n,onSubmit:a})})]})},N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};s.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(g,{})}),document.getElementById("root")),N()}},[[16,1,2]]]);
//# sourceMappingURL=main.4e4f9c29.chunk.js.map