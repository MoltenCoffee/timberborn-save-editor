{"version":3,"sources":["LoadSaveCard.tsx","Navbar.tsx","util/UUID.ts","SaveContext.ts","BeaverUtil.ts","deepCopy.ts","plugins/BeaverCopier.tsx","plugins/DownloadPlugin.tsx","plugins/MapSizePlugin.tsx","StockpileUtil.ts","plugins/StockpilePlugin.tsx","allPlugins.ts","PluginIndex.tsx","PluginShow.tsx","SaveEditor.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["LoadSaveCard","onSaveLoaded","useState","error","setError","onInput","useCallback","event","fileList","target","files","file","item","Error","reader","FileReader","onload","_event","data","JSON","parse","result","readAsText","className","type","name","accept","Navbar","saveData","onHome","href","onClick","e","preventDefault","SaveContext","createContext","undefined","lut","i","toString","BeaverUtil","setAge","beaver","age","dayNumber","Singletons","DayNightCycle","DayNumber","Components","Beaver","DayOfBirth","Math","floor","setDefaultNeeds","NeedManager","Needs","need","includes","Name","Points","setDefaultName","names","NameService","Names","sample","reset","Id","d0","random","d1","d2","d3","UUID","Object","assign","BehaviorManager","RunningBehaviorId","RunningBehaviorOwner","ReturnToBehavior","TimestampedBehaviorLog","MortalNeeder","DeathDays","Worker","deepCopy","obj","stringify","BeaverCopier","id","group","position","enabled","read","write","Preview","BeaverStatus","entities","Entities","Editor","initialData","onClose","onSubmit","filter","_","TemplateName","beavers","setBeavers","page","setPage","pageSize","setPageSize","targetAmount","setTargetAmount","sortedBeavers","sortBy","slice","offset","copyBeaver","newBeaver","duplicate","concat","doSubmit","hasNextPage","length","doSetBeaverCount","adults","newBeavers","samples","push","style","fontWeight","map","round","Position","X","Y","Z","colSpan","min","htmlFor","value","onChange","parseInt","width","Number","MAX_SAFE_INTEGER","disabled","reduce","acc","entity","adultCount","childCount","sum","DownloadPlugin","blob","useMemo","Blob","url","URL","createObjectURL","now","Date","filename","toISOString","substr","getHours","getMinutes","CycleService","Cycle","CycleDay","download","MapSizePlugin","x","MapSize","Size","y","setData","StockpileUtil","stockpile","accumulator","Storage","Goods","Good","Amount","StockpilePlugin","save","stockpiles","allGoods","StockpileInventoryTable","counts","stockpileId","setStockpileId","setStockpiles","setStockpile","mappedStockpiles","mapValues","groupBy","arr","StockpileForm","StockpileButton","goods","GoodDesirer","DesiredGoods","setCounts","toPairs","v","setCount","good","count","BlockObject","Coordinates","valueAsNumber","chunk","index","fill","Array","label","allPlugins","values","pluginsImport","PluginIndex","onSelectPlugin","groupedPlugins","groupName","plugins","PluginShow","pluginId","find","onSubmitData","newData","SaveEditor","setPluginId","onSubmitPlugin","window","confirm","App","setSaveData","Provider","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b9d60045.chunk.js","sourcesContent":["import { FormEvent, useCallback, useState } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\n\nexport function LoadSaveCard({ onSaveLoaded }: { onSaveLoaded: (save: DemoSave) => void }) {\n  const [ error, setError ] = useState<unknown>();\n\n  const onInput = useCallback((event: FormEvent<HTMLInputElement>) => {\n    try {\n      const fileList = (event.target as HTMLInputElement|null)?.files;\n      const file = fileList?.item(0);\n      if (!file) {\n        throw new Error(`Expected file to be uploaded, found none`);\n      }\n      const reader = new FileReader();\n      reader.onload = (_event) => {\n        try {\n          const data = JSON.parse(reader.result as string);\n          onSaveLoaded(data);\n        } catch (error) {\n          setError(error);\n          throw error;\n        }\n      }\n      reader.readAsText(file, \"utf-8\");\n    } catch (error) {\n      setError(error);\n      throw error;\n    }\n  }, [onSaveLoaded, setError]);\n\n  return <div className=\"container my-4\">\n    <div className=\"row\">\n      <div className=\"col-md-6 offset-md-3\">\n        <label className=\"card\">\n          <div className=\"card-body\">\n            <h1 className=\"card-title\">Timberborn Save Editor</h1>\n            <div className=\"mb-3\">\n              <span className=\"form-label\">Upload your <b>Demo save</b> to start</span>\n              <input type=\"file\" name=\"save\" accept=\".json\" onInput={onInput} className=\"form-control\" />\n              {error\n                ? <small className=\"form-text\">{`#{error}`}</small>\n                : <small className=\"form-text\">Default directory: <code>%USERPROFILE%\\Documents\\Timberborn\\DemoSaves\\</code></small>}\n            </div>\n          </div>\n        </label>\n      </div>\n    </div>\n  </div>\n}\n","import { DemoSave } from \"./DemoSave\";\n\nexport function Navbar({ saveData, onHome }: { saveData?: DemoSave, onHome: () => void }) {\n  return <nav className=\"navbar navbar-light bg-light\">\n    <div className=\"container\">\n    {// eslint-disable-next-line\n    }<a href=\"#\" onClick={(e) => { e.preventDefault(); onHome(); }} className=\"navbar-brand\">Timberborn Save Editor</a>\n    </div>\n  </nav>\n}\n","/*eslint-disable*/\n\n/**\n * Fast UUID generator, RFC4122 version 4 compliant.\n * @author Jeff Ward (jcward.com).\n * @license MIT license\n * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\n **/\n\nconst lut: string[] = [];\nfor (var i=0; i<256; i++) { lut[i] = (i<16?'0':'')+(i).toString(16); }\n\nexport function UUID() {\n  var d0 = Math.random()*0xffffffff|0;\n  var d1 = Math.random()*0xffffffff|0;\n  var d2 = Math.random()*0xffffffff|0;\n  var d3 = Math.random()*0xffffffff|0;\n  return lut[d0&0xff]+lut[d0>>8&0xff]+lut[d0>>16&0xff]+lut[d0>>24&0xff]+'-'+\n    lut[d1&0xff]+lut[d1>>8&0xff]+'-'+lut[d1>>16&0x0f|0x40]+lut[d1>>24&0xff]+'-'+\n    lut[d2&0x3f|0x80]+lut[d2>>8&0xff]+'-'+lut[d2>>16&0xff]+lut[d2>>24&0xff]+\n    lut[d3&0xff]+lut[d3>>8&0xff]+lut[d3>>16&0xff]+lut[d3>>24&0xff];\n}\n","import { createContext } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\n\nexport const SaveContext = createContext<{ saveData: DemoSave }>(undefined as any);\n","import { sample } from \"lodash\";\nimport { DemoSave, UnknownEntity } from \"./DemoSave\";\nimport { UUID } from \"./util/UUID\";\n\nexport const BeaverUtil = {\n  setAge(saveData: DemoSave, beaver: UnknownEntity, age: number) {\n    const dayNumber = saveData.Singletons.DayNightCycle.DayNumber;\n    (beaver.Components.Beaver as any).DayOfBirth = Math.floor(dayNumber - age);\n  },\n\n  /**\n   * Set the default needs for a beaver\n   * @param beaver\n   */\n  setDefaultNeeds(beaver: UnknownEntity): void {\n    for (const need of (beaver.Components.NeedManager as any).Needs) {\n      if ([\"Hunger\", \"Thirst\", \"Sleep\"].includes(need.Name)) {\n        need.Points = 1.0;\n      }\n    }\n  },\n\n  setDefaultName(saveData: DemoSave, beaver: UnknownEntity): void {\n    const names = saveData.Singletons.NameService.Names;\n    (beaver.Components.Beaver as any).Name = sample(names);\n  },\n\n  reset(beaver: UnknownEntity) {\n    beaver.Id = UUID();\n    BeaverUtil.setDefaultNeeds(beaver);\n    Object.assign(beaver.Components, {\n      BehaviorManager: {\n        RunningBehaviorId: \"HomelessRootBehavior\",\n        RunningBehaviorOwner: beaver.Id,\n        ReturnToBehavior: false,\n        TimestampedBehaviorLog: [\n          \"HomelessRootBehavior 1.00\"\n        ]\n      },\n      MortalNeeder: { DeathDays: [] },\n      Worker: {},\n    });\n  }\n}\n","/**\n * A dirty way to create a deep-copy of a save. The deep copy is usually created\n * to prevent the original copy from being edited or to force a re-render when\n * one of its deep objects might have been updated.\n * @param save\n * @returns\n */\nexport function deepCopy<T>(obj: T): T {\n  return JSON.parse(JSON.stringify(obj));\n}\n","import { sample, sortBy } from \"lodash\";\nimport { useCallback, useState } from \"react\";\nimport { BeaverUtil } from \"../BeaverUtil\";\nimport { deepCopy } from \"../deepCopy\";\nimport { DemoSave, DemoSaveEntity, UnknownEntity } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\nexport const BeaverCopier: IEditorPlugin<DemoSave, DemoSave> = {\n  id: \"BeaverCopier\",\n  name: \"Beaver copier\",\n  group: \"Beavers\",\n  position: 1,\n  enabled: true,\n\n  read(saveData) {\n    return saveData;\n  },\n\n  write(saveData, data) {\n    return data;\n  },\n\n  Preview({ saveData }) {\n    return <BeaverStatus entities={saveData.Entities} />;\n  },\n\n  Editor({ initialData, onClose, onSubmit }) {\n    const [ beavers, setBeavers ] = useState(() => initialData.Entities.filter(_ => _.TemplateName === \"BeaverChild\" || _.TemplateName === \"BeaverAdult\"))\n    const [ page, setPage ] = useState(0);\n    const [ pageSize, setPageSize ] = useState(10);\n    const [ targetAmount, setTargetAmount ] = useState(70);\n\n    const sortedBeavers = sortBy(beavers.slice(), _ => -(_ as any).Components.Beaver.DayOfBirth);\n\n    const offset = page * pageSize;\n\n    const copyBeaver = useCallback((beaver: UnknownEntity) => {\n      const newBeaver = deepCopy(beaver);\n      BeaverUtil.reset(newBeaver);\n      BeaverUtil.setDefaultName(initialData, newBeaver);\n      if (newBeaver.TemplateName === \"BeaverAdult\") {\n        BeaverUtil.setAge(initialData, beaver, 5)\n      }\n      return newBeaver;\n    }, [initialData]);\n\n    const duplicate = useCallback((beaver: UnknownEntity) => {\n      setBeavers(beavers.slice().concat([copyBeaver(beaver)]));\n    }, [beavers, setBeavers, copyBeaver]);\n\n    const doSubmit = useCallback(() => {\n      const Entities = initialData.Entities\n        .filter(_ => _.TemplateName !== \"BeaverChild\" && _.TemplateName !== \"BeaverAdult\")\n        .concat(beavers);\n\n      onSubmit({ ...initialData, Entities });\n    }, [onSubmit, beavers, initialData]);\n\n    const hasNextPage = pageSize + offset < beavers.length;\n\n    const doSetBeaverCount = useCallback(() => {\n      const adults = beavers.filter(_ => _.TemplateName === \"BeaverAdult\");\n      const newBeavers = (adults.length > 0 ? adults : beavers).slice(0, targetAmount);\n      const samples = newBeavers.slice();\n      while (newBeavers.length < targetAmount) {\n        newBeavers.push(copyBeaver(sample(samples)!));\n      }\n      setBeavers(newBeavers);\n    }, [beavers, targetAmount, copyBeaver]);\n\n    return <div className=\"container my-4\">\n      <div className=\"card\">\n        <div className=\"card-body\">\n          <h1 className=\"card-title\">Beaver Copier</h1>\n          <div className=\"d-flex\">\n            <div>\n              <BeaverStatus entities={beavers} />\n            </div>\n            <div className=\"ms-auto\">\n              <button type=\"button\" onClick={onClose} className=\"btn btn-light\">Discard changes</button>\n              {\" \"}\n              <button type=\"button\" onClick={doSubmit} className=\"btn btn-primary\">Submit</button>\n            </div>\n          </div>\n          {beavers.length > 80 ? <div className=\"alert alert-danger mt-1\">\n            <b>WARNING:</b> You have {beavers.length} beavers. Newer versions of\n            the Timberborn Demo will randomly crash with over 80 beavers.\n          </div> : null}\n        </div>\n        <table className=\"table my-0\">\n          <thead>\n            <tr>\n              <th>Name</th>\n              <th>Age <small style={{fontWeight: \"normal\"}}>a-z</small></th>\n              <th>Coordinates</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>\n            {sortedBeavers.slice(offset, offset + pageSize).map((beaver: any) => <tr key={beaver.Id}>\n              <td>{beaver.Components.Beaver.Name}</td>\n              <td>{initialData.Singletons.DayNightCycle.DayNumber - beaver.Components.Beaver.DayOfBirth} {beaver.TemplateName === \"BeaverChild\" ? <small>(child)</small> : null}</td>\n              <td>\n                x: <b>{Math.round(beaver.Components.Beaver.Position.X)}</b>{\" \"}\n                y: <b>{Math.round(beaver.Components.Beaver.Position.Y)}</b>{\" \"}\n                z: <b>{Math.round(beaver.Components.Beaver.Position.Z)}</b>{\" \"}\n              </td>\n              <td className=\"text-end py-1\">\n                <button type=\"button\" className=\"btn btn-light btn-sm\" onClick={() => duplicate(beaver)}>Copy</button>\n              </td>\n            </tr>)}\n          </tbody>\n          <tfoot>\n            <tr>\n              <td colSpan={4} className=\"py-1\">\n                <div className=\"d-flex\">\n                  <div className=\"me-auto\">\n                    Showing <strong>{offset}</strong> - <strong>{Math.min(beavers.length, offset + pageSize)}</strong> of <strong>{beavers.length}</strong>\n                  </div>\n                  <form className=\"me-3 d-flex\" onSubmit={(event) => { event.preventDefault(); doSetBeaverCount(); }}>\n                    <label className=\"form-label me-1 mt-1 mb-0\" htmlFor=\"addRandom\">Set beavers</label>\n                    <input type=\"number\" id=\"addRandom\" className=\"form-control form-control-sm\" value={targetAmount}\n                      onChange={(event) => { setTargetAmount(parseInt(event.target.value, 10)) }} width={3} style={{width: 60}} />\n                    <button type=\"submit\" className=\"ms-1 btn btn-primary btn-sm\">Set</button>\n                  </form>\n                  <div className=\"me-3 d-flex\">\n                    <label className=\"form-label me-1 mt-1 mb-0\" htmlFor=\"pageSize\">Pagesize</label>\n                    <select id=\"pageSize\" className=\"form-control form-control-sm\" value={pageSize} onChange={(event) => { setPage(0); setPageSize(parseInt(event.target.value, 10)) }}>\n                      <option>10</option>\n                      <option>25</option>\n                      <option>100</option>\n                      <option>250</option>\n                      <option>1000</option>\n                      <option value={`${Number.MAX_SAFE_INTEGER}`}>ALL</option>\n                    </select>\n                  </div>\n                  <div>\n                    <button className=\"btn btn-sm btn-light\" disabled={page<=0} onClick={() => setPage(page-1)}>&lsaquo; prev</button>\n                    {\" \"}\n                    <button className=\"btn btn-sm btn-light\" disabled={!hasNextPage} onClick={() => setPage(page+1)}>next &rsaquo;</button>\n                  </div>\n                </div>\n              </td>\n            </tr>\n          </tfoot>\n        </table>\n      </div>\n    </div>;\n  }\n}\n\nfunction BeaverStatus({entities}: {entities: DemoSaveEntity[]}) {\n  const {adultCount, childCount} = entities.reduce((acc, entity) => {\n    if (entity.TemplateName === \"BeaverAdult\") {\n      acc.adultCount++;\n    }\n    if (entity.TemplateName === \"BeaverChild\") {\n      acc.childCount++;\n    }\n    return acc;\n  }, { adultCount: 0, childCount: 0 })\n\n  const sum = adultCount+childCount;\n\n  return <span>You have <strong>{sum}</strong> beavers: <strong>{childCount}</strong> kits and <strong>{adultCount}</strong> adults.</span>;\n\n}\n","import { useMemo } from \"react\";\nimport { DemoSave } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\nexport const DownloadPlugin: IEditorPlugin<DemoSave, DemoSave> = {\n  id: \"DownloadPlugin\",\n  name: \"Download\",\n  group: \"General\",\n  position: -1,\n  enabled: true,\n\n  read(saveData) {\n    return saveData;\n  },\n\n  write(saveData, data) {\n    throw new Error(`Not implemented`);\n  },\n\n  Preview({ saveData }) {\n    return null;\n  },\n\n  Editor({ initialData, onClose }) {\n    const blob = useMemo(() => new Blob([JSON.stringify(initialData, null, 2)], {type: 'application/json'}), [initialData]);\n    const url = URL.createObjectURL(blob);\n\n    const now = new Date();\n    const filename = `${now.toISOString().substr(0, 10)} ${now.getHours()}h${now.getMinutes()}m, Day ${initialData.Singletons.CycleService.Cycle}-${initialData.Singletons.CycleService.CycleDay} MODDED.json`;\n\n    return <div className=\"container\">\n      <div className=\"card my-4\">\n        <div className=\"card-body\">\n          <h1 className=\"card-title\">Download</h1>\n          <div className=\"d-flex\">\n            <a href={url} download={filename} className=\"btn btn-primary\" onClick={() => onClose()}>Download</a>\n            <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Close</button>\n          </div>\n        </div>\n      </div>\n    </div>;\n  }\n}\n","import { useState } from \"react\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\ninterface MapSizeParams {\n  x: number;\n  y: number;\n}\n\nexport const MapSizePlugin: IEditorPlugin<MapSizeParams, MapSizeParams> = {\n  id: \"MapSizePlugin\",\n  name: \"Map size\",\n  group: \"General\",\n  position: -1,\n  enabled: true,\n\n  read(saveData) {\n    const x = saveData.Singletons.MapSize.Size.X;\n    const y = saveData.Singletons.MapSize.Size.Y;\n    return { x, y };\n  },\n\n  write(saveData, data) {\n    saveData.Singletons.MapSize.Size.X = data.x;\n    saveData.Singletons.MapSize.Size.Y = data.y;\n    return saveData;\n  },\n\n  Preview({ saveData }) {\n    const x = saveData.Singletons.MapSize.Size.X;\n    const y = saveData.Singletons.MapSize.Size.Y;\n    return <span>\n      <strong>{x}</strong> &times; <strong>{y}</strong>\n    </span>;\n  },\n\n  Editor({ initialData, onClose, onSubmit }) {\n    const [data, setData] = useState(initialData);\n\n    return <form onSubmit={(e) => { e.preventDefault(); onSubmit(data); }}>\n      <div className=\"container\">\n        <div className=\"card my-4\">\n          <div className=\"card-body\">\n            <h1 className=\"card-title\">Map size editor</h1>\n            <p>This is just a demo editor - changing this will likely break something.</p>\n            <div className=\"mb-3\">\n              <label htmlFor=\"x\" className=\"form-label\">X</label>\n              <input id=\"x\" type=\"number\" className=\"form-control\" value={data.x} onInput={(e) => setData({ ...data, x: parseInt((e.target as HTMLInputElement).value, 10) })} />\n            </div>\n            <div className=\"mb-3\">\n              <label htmlFor=\"y\" className=\"form-label\">Y</label>\n              <input id=\"y\" type=\"number\" className=\"form-control\" value={data.y} onInput={(e) => setData({ ...data, y: parseInt((e.target as HTMLInputElement).value, 10) })} />\n            </div>\n            <div className=\"d-flex\">\n              <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\n              <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Discard changes</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </form>;\n  }\n}\n","import { DemoSave, UnknownEntity } from \"./DemoSave\";\n\ninterface StockpileGoodsEntry {\n  Good: { Id: string };\n  Amount: number;\n}\n\nexport const StockpileUtil = {\n  getStockpiles: (saveData: DemoSave) => saveData.Entities.filter(_ => _.TemplateName === \"SmallWarehouse\"),\n  countGoods: (stockpile: UnknownEntity, accumulator = {} as Record<string, number>) => ((stockpile.Components[\"Inventory:Stockpile\"] as any).Storage.Goods as StockpileGoodsEntry[])\n    .reduce((acc, { Good, Amount }) => ({ ...acc, [Good.Id]: Amount + (acc[Good.Id] || 0) }), accumulator)\n}\n","import { assign, chunk, fill, groupBy, mapValues, toPairs } from \"lodash\";\nimport { FormEvent, useCallback, useMemo, useState } from \"react\";\nimport { DemoSave, UnknownEntity } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\nimport { StockpileUtil } from \"../StockpileUtil\";\n\nexport const StockpilePlugin: IEditorPlugin<DemoSave, DemoSave> = {\n  id: \"StockpilePlugin\",\n  name: \"Manage stockpile inventories\",\n  group: \"Storage\",\n  position: 10,\n  enabled: true,\n\n  read: (save) => save,\n  write: (_, data) => data,\n\n  Preview: ({ saveData }) => {\n    const stockpiles = useMemo(() => StockpileUtil.getStockpiles(saveData), [saveData]);\n    const allGoods = useMemo(() => stockpiles.reduce((acc, stockpile) => StockpileUtil.countGoods(stockpile, acc), {} as Record<string, number>), [stockpiles]);\n\n    return <div>\n      <StockpileInventoryTable counts={allGoods} />\n    </div>\n  },\n\n  Editor: ({ initialData, onClose, onSubmit }) => {\n    const [ stockpileId, setStockpileId ] = useState<string|null>(null);\n    const [ stockpiles, setStockpiles ] = useState(() => StockpileUtil.getStockpiles(initialData));\n\n    const setStockpile = useCallback((stockpile: UnknownEntity) => {\n      setStockpiles(stockpiles.slice().map((_) => _.Id === stockpile.Id ? stockpile : _));\n      setStockpileId(null);\n    }, [setStockpiles, stockpiles, setStockpileId])\n\n    const doSubmit = useCallback(() => {\n      const mappedStockpiles = mapValues(groupBy(stockpiles, \"Id\"), (arr) => arr[0]);\n\n      onSubmit({\n        ...initialData,\n        Entities: initialData.Entities.map((_) => mappedStockpiles[_.Id] ? mappedStockpiles[_.Id] : _),\n      });\n    }, [onSubmit, initialData, stockpiles]);\n\n    return <div className=\"container my-4\">\n      <div className=\"card\">\n        <div className=\"card-body\">\n          <h1 className=\"card-title\">Manage stockpile inventories</h1>\n          <div className=\"d-flex\">\n            <button type=\"button\" className=\"btn btn-primary\" onClick={doSubmit}>Submit</button>\n            <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Discard changes</button>\n          </div>\n        </div>\n        <div className=\"list-group list-group-flush\">\n          {stockpiles.map((stockpile) => stockpileId === stockpile.Id\n            ? <StockpileForm key={stockpile.Id} setStockpile={setStockpile} stockpile={stockpile} />\n            : <StockpileButton key={stockpile.Id} setStockpileId={setStockpileId} stockpile={stockpile} />)}\n        </div>\n      </div>\n    </div>\n  }\n}\n\nfunction StockpileForm({ stockpile, setStockpile }: { stockpile: UnknownEntity, setStockpile: (stockpile: UnknownEntity) => void }) {\n  const goods: string[] = useMemo(() => (stockpile.Components.GoodDesirer as any).DesiredGoods.map((_: any) => _.Good.Id), [stockpile]);\n  const [ counts, setCounts ] = useState(() => StockpileUtil.countGoods(stockpile));\n\n  const onSubmit = useCallback((event: FormEvent) => {\n    event.preventDefault();\n    setStockpile({\n      ...stockpile,\n      Components: {\n        ...stockpile.Components,\n        \"Inventory:Stockpile\": {\n          Storage: {\n            Goods: toPairs(counts).filter(([k,v]) => v && v > 0).map(([Id, Amount]) => ({ Good: {Id}, Amount }))\n          }\n        }\n      }\n    })\n  }, [stockpile, setStockpile, counts]);\n\n\n  const setCount = useCallback((good: string, count: number) => {\n    setCounts({ ...counts, [good]: count });\n  }, [setCounts, counts]);\n\n  return <div className=\"list-group-item\">\n    <div className=\"d-flex\">\n      <div>\n        <b>{stockpile.TemplateName}</b>\n        <div>\n          x: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.X)}</b>{\" \"}\n          y: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Y)}</b>{\" \"}\n          z: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Z)}</b>{\" \"}\n        </div>\n      </div>\n      <form className=\"flex-fill\" onSubmit={onSubmit}>\n        {goods.map((good) => <div key={good} className=\"row mb-3\">\n          <label className=\"col-sm-2 col-form-label col-form-label-sm text-end\">{good}</label>\n          <div className=\"col-sm-10\">\n            <input className=\"form-control form-control-sm\" type=\"number\" onChange={(event) => { setCount(good, event.target.valueAsNumber) }} value={counts[good] || \"\"} />\n          </div>\n        </div>)}\n        <div className=\"row\">\n          <div className=\"col-sm-10 offset-sm-2\">\n            <button type=\"submit\" className=\"btn btn-primary btn-sm\">OK</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n}\n\nfunction StockpileButton({ stockpile, setStockpileId }: { stockpile: UnknownEntity, setStockpileId: (id: string) => void }) {\n  return <button onClick={() => setStockpileId(stockpile.Id)} className=\"list-group-item list-group-item-action\">\n    <div className=\"d-flex\">\n      <div>\n        <b>{stockpile.TemplateName}</b>\n        <div>\n          x: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.X)}</b>{\" \"}\n          y: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Y)}</b>{\" \"}\n          z: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Z)}</b>{\" \"}\n        </div>\n      </div>\n      <StockpileInventoryTable counts={StockpileUtil.countGoods(stockpile)} />\n    </div>\n  </button>;\n}\n\nfunction StockpileInventoryTable({ counts }: { counts: Record<string, number> }) {\n  return <table className=\"table table-sm table-borderless my-0\">\n    <tbody>\n      {chunk(toPairs(counts), 5).map((chunk, index) => <tr key={index}>\n        {assign(fill(new Array(5), [\"\", \"\"]), chunk).map(([label, value], i) => <>\n          <th style={{width: \"17%\"}} key={\"k\"+i} className=\"text-end\">{label}</th>\n          <td style={{width: \"3%\"}} className=\"text-end\" key={\"v\"+i}>{value}</td>\n        </>)}\n      </tr>)}\n    </tbody>\n  </table>;\n}\n","import { sortBy } from \"lodash\";\nimport { IEditorPlugin } from \"./IEditorPlugin\";\nimport * as pluginsImport from \"./plugins\";\n\nexport const allPlugins: IEditorPlugin<any, any>[] = sortBy(Object\n  .values(pluginsImport)\n  .filter(_ => _ && typeof _ === \"object\"), \"position\");\n","import { useMemo } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\nimport { allPlugins } from \"./allPlugins\";\nimport { groupBy, toPairs } from \"lodash\";\n\nexport function PluginIndex({ saveData, onSelectPlugin }: { saveData: DemoSave, onSelectPlugin: (pluginId: string) => void }) {\n  const groupedPlugins = useMemo(() => toPairs(groupBy(allPlugins\n    .filter(_ => typeof _.enabled === \"function\" ? _.enabled({saveData}) : _.enabled), \"group\")), [saveData]);\n\n  return <div className=\"container\">\n    {groupedPlugins.map(([groupName, plugins]) => <div key={groupName} className=\"my-2\">\n      <h2 className=\"ps-2\">{groupName}</h2>\n      <div className=\"list-group my-2\">\n      {plugins.map(({ id, name, Preview }) => <button type=\"button\" key={id} onClick={(e) => {e.preventDefault(); onSelectPlugin(id)}} className=\"list-group-item list-group-item-action\">\n        <div className=\"fw-bold\">{name}</div>\n        <div><Preview saveData={saveData} /></div>\n      </button>)}\n      </div>\n    </div>)}\n  </div>\n}\n","import { useCallback, useMemo } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\nimport { allPlugins } from \"./allPlugins\";\nimport { deepCopy } from \"./deepCopy\";\n\nexport function PluginShow({ saveData, pluginId, onClose, onSubmit }: { saveData: DemoSave, pluginId: string, onClose: () => void; onSubmit: (save: DemoSave) => void }) {\n  const {Editor, read, write} = useMemo(() => allPlugins.find(_ => _.id === pluginId), [pluginId])!;\n\n  const data = useMemo(() => read(deepCopy(saveData)), [read, saveData]);\n\n  const onSubmitData = useCallback((newData: unknown) => {\n    onSubmit(deepCopy(write(saveData, newData)));\n  }, [write, saveData, onSubmit]);\n\n  return <Editor initialData={data} onClose={onClose} onSubmit={onSubmitData} />;\n}\n","import { useCallback, useState } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\nimport { Navbar } from \"./Navbar\";\nimport { PluginIndex } from \"./PluginIndex\";\nimport { PluginShow } from \"./PluginShow\";\n\nexport function SaveEditor({ saveData, onSubmit }: { saveData: DemoSave, onSubmit: (saveData: DemoSave|null) => void }) {\n  const [pluginId, setPluginId] = useState<null|string>(null);\n\n  const onSubmitPlugin = useCallback((saveData: DemoSave) => {\n    onSubmit(saveData);\n    setPluginId(null);\n  }, [onSubmit]);\n\n  const onHome = useCallback(() => {\n    if (pluginId) {\n      if (window.confirm(\"Discard changes in this form? Earlier changes will not be discarded.\")) {\n        setPluginId(null);\n      }\n    } else if (window.confirm(\"Close this save file?\")) {\n      onSubmit(null);\n    }\n  }, [pluginId, onSubmit]);\n\n  return <>\n    <Navbar onHome={onHome} />\n    {pluginId === null\n      ? <PluginIndex saveData={saveData} onSelectPlugin={setPluginId} />\n      : <PluginShow saveData={saveData} pluginId={pluginId} onClose={() => setPluginId(null)} onSubmit={onSubmitPlugin} />}\n  </>;\n}\n","import { useState } from 'react';\nimport './App.css';\nimport { DemoSave } from './DemoSave';\nimport { LoadSaveCard } from './LoadSaveCard';\nimport { Navbar } from './Navbar';\nimport { SaveContext } from './SaveContext';\nimport { SaveEditor } from './SaveEditor';\n\nfunction App() {\n  const [ saveData, setSaveData ] = useState<DemoSave|null>(null);\n\n  return <>\n    {saveData === null\n      ? <>\n        <Navbar onHome={() => { /* do nothing */ }} />\n        <LoadSaveCard onSaveLoaded={setSaveData} />\n      </>\n      : <SaveContext.Provider value={{saveData}}>\n        <SaveEditor saveData={saveData} onSubmit={setSaveData} />\n      </SaveContext.Provider>}\n  </>;\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}