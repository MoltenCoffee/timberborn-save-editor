{"version":3,"sources":["deepCopy.ts","LoadSaveCard.tsx","Navbar.tsx","util/UUID.ts","SaveContext.ts","BeaverUtil.ts","plugins/BeaverCopier.tsx","plugins/DownloadPlugin.tsx","StockpileUtil.ts","plugins/MapPlugin.tsx","plugins/MapSizePlugin.tsx","plugins/PropertiesPlugin.tsx","plugins/StockpilePlugin.tsx","allPlugins.ts","PluginIndex.tsx","PluginShow.tsx","SaveEditor.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["deepCopy","obj","JSON","parse","stringify","exmapleLetsPlay","require","exampleIronTeeth","LoadSaveCard","onSaveLoaded","useState","error","setError","onInput","useCallback","event","fileList","target","files","file","item","Error","reader","FileReader","onload","_event","data","result","__originalFilename","name","readAsText","loadExample","filename","className","type","accept","onClick","e","href","rel","style","display","lineHeight","verticalAlign","Navbar","saveData","onHome","preventDefault","SaveContext","createContext","undefined","lut","i","toString","BeaverUtil","setAge","beaver","age","dayNumber","Singletons","DayNightCycle","DayNumber","Components","Beaver","DayOfBirth","Math","floor","setDefaultNeeds","MortalNeeder","DeathDays","NeedManager","Needs","need","includes","Name","Points","setDefaultName","names","NameService","Names","sample","reset","Id","d0","random","d1","d2","d3","UUID","Object","assign","BehaviorManager","RunningBehaviorId","RunningBehaviorOwner","ReturnToBehavior","TimestampedBehaviorLog","Dweller","Worker","BeaverCopier","id","group","position","enabled","read","write","Preview","BeaverStatus","entities","Entities","Editor","initialData","onClose","onSubmit","filter","_","Template","beavers","setBeavers","page","setPage","pageSize","setPageSize","targetAmount","setTargetAmount","sortedBeavers","sortBy","slice","offset","copyBeaver","newBeaver","duplicate","concat","doSubmit","hasNextPage","length","doSetBeaverCount","adults","newBeavers","push","fontWeight","map","round","Position","X","Y","Z","colSpan","min","htmlFor","value","onChange","parseInt","width","Number","MAX_SAFE_INTEGER","disabled","reduce","acc","entity","adultCount","childCount","sum","DownloadPlugin","Infinity","GameVersion","replace","blob","useMemo","Blob","url","URL","createObjectURL","now","Date","toISOString","substr","getHours","getMinutes","setFilename","download","endsWith","stockpileTypes","capacity","stockpileIds","StockpileUtil","getCapacity","stockpile","find","getStockpiles","countGoods","accumulator","Storage","Goods","Good","Amount","SSAO","_SSAO","BlendFunction","BufferGeometryUtils","STOCKPILE_ENTITIES","TREE_ENTITIES","BEAVER_ENTITIES","PATH_ENTITIES","PLATFORM_ENTITIES","EDITABLE_ENTITIES","useEntitiesOfTypes","entityData","templateIds","entitiesIdsByTemplate","entitiesByIds","lodash","flatten","compact","toJSON","readEntityData","deleteIds","updateIds","readMapData","mapSizeX","MapSize","Size","mapSizeY","i2x","index","i2y","i2xy","i2xyz","y","heightMap","Uint8Array","from","TerrainMap","Heights","Array","split","moistureMap","Float32Array","SoilMoistureSimulator","MoistureLevels","parseFloat","waterDepthMap","WaterMap","WaterDepths","MapPlugin","mapData","state","setState","selectedEntityId","setSelectedEntityId","selectedEntity","setEntity","oldEntity","newState","uniq","selectEntityId","Gui","camera","blendFunction","MULTIPLY","samples","radius","intensity","scale","SlowBoxesHeightMap","SlowBoxesWaterMap","TreesMap","PlatformsMap","PathsMap","StockpilesMap","BeaversMap","MapControls","StockpileForm","BeaverForm","setBeaver","getValue","path","get","setValue","format","x","set","max","step","val","stockpiles","Stockpile","selected","isHover","setIsHover","pos","BlockObject","Coordinates","z","meshRef","useRef","template","useLayoutEffect","current","sizeY","sizeZ","geom","test","mergeBufferGeometries","BoxBufferGeometry","translate","CylinderBufferGeometry","sizeX","rotate","geometry","ref","onPointerEnter","onPointerLeave","opacity","transparent","color","isAdult","args","goodIds","GoodDesirer","DesiredGoods","setCountGoods","totalCounts","values","a","b","newEntity","toPairs","goodId","valueAsNumber","createTreeGeom","dry","dead","adult","ConeBufferGeometry","meshWithColorFromGeoms","geometries","Mesh","mat","MeshStandardMaterial","rotateY","orientationMatch","Orientation","Value","match","PI","getEntityRotationY","paths","mesh","PlaneBufferGeometry","rotateX","object","height","treeEntities","trees","WateredNaturalResource","DryingProgress","Growable","GrowthProgress","greenTrees","brownTrees","isWet","box","wetBoxes","dryBoxes","wetLand","dryLand","MapSizePlugin","console","log","arr","indexOf","setData","parseIntValue","fields","label","PropertiesPlugin","join","fromJS","toJS","field","getIn","setIn","StockpilePlugin","save","allGoods","StockpileInventoryTable","counts","stockpileId","setStockpileId","setStockpiles","setStockpile","mappedStockpiles","mapValues","groupBy","StockpileButton","goods","setCounts","nativeEvent","submitter","getAttribute","v","setCount","good","count","whiteSpace","chunk","fill","allPlugins","pluginsImport","PluginIndex","onSelectPlugin","groupedPlugins","groupName","plugins","PluginShow","pluginId","onSubmitData","newData","SaveEditor","setPluginId","onSubmitPlugin","window","confirm","App","setSaveData","Provider","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.a9f35200.chunk.js","sourcesContent":["/**\n * A dirty way to create a deep-copy of a save. The deep copy is usually created\n * to prevent the original copy from being edited or to force a re-render when\n * one of its deep objects might have been updated.\n * @param save\n * @returns\n */\nexport function deepCopy<T>(obj: T): T {\n  return JSON.parse(JSON.stringify(obj));\n}\n","import { FormEvent, useCallback, useState } from \"react\";\nimport { deepCopy } from \"./deepCopy\";\nimport { DemoSave } from \"./DemoSave\";\n\nconst exmapleLetsPlay = require(\"./examples/lets-play-plains.json\");\nconst exampleIronTeeth = require(\"./examples/iron-teeth-plains-1-1.json\");\n\nexport function LoadSaveCard({ onSaveLoaded }: { onSaveLoaded: (save: DemoSave) => void }) {\n  const [ error, setError ] = useState<unknown>();\n\n  const onInput = useCallback((event: FormEvent<HTMLInputElement>) => {\n    try {\n      const fileList = (event.target as HTMLInputElement|null)?.files;\n      const file = fileList?.item(0);\n      if (!file) {\n        throw new Error(`Expected file to be uploaded, found none`);\n      }\n      const reader = new FileReader();\n      reader.onload = (_event) => {\n        try {\n          const data = JSON.parse(reader.result as string);\n          data.__originalFilename = file.name;\n          onSaveLoaded(data);\n        } catch (error) {\n          setError(error);\n          throw error;\n        }\n      }\n      reader.readAsText(file, \"utf-8\");\n    } catch (error) {\n      setError(error);\n      throw error;\n    }\n  }, [onSaveLoaded, setError]);\n\n  const loadExample = useCallback((filename: string, data: DemoSave) => {\n    data.__originalFilename = filename;\n    onSaveLoaded(deepCopy(data));\n  }, [onSaveLoaded]);\n\n  return <div className=\"container my-4\">\n    <div className=\"row\">\n      <div className=\"col-md-6 offset-md-3\">\n        <div className=\"card\">\n          <label className=\"card-body\">\n            <small className=\"text-danger\">A very unofficial &amp; third-party</small>\n            <h1 className=\"card-title\">Timberborn Save Editor</h1>\n            <div className=\"mb-3 mt-4\">\n              <span className=\"form-label\">Upload your <b>Demo save</b> to start</span>\n              <input type=\"file\" name=\"save\" accept=\".json\" onInput={onInput} className=\"form-control\" />\n              {error\n                ? <small className=\"form-text\">{`#{error}`}</small>\n                : <small className=\"form-text\">Default directory: <code>%USERPROFILE%\\Documents\\Timberborn\\Saves\\</code></small>}\n            </div>\n          </label>\n          <div className=\"card-body\">\n            <small className=\"form-text\">Or load an example save</small>\n            <br />\n            <button className=\"btn btn-link\" onClick={(e) => loadExample(\"iron-teeth-plains-1-1.json\", exampleIronTeeth)}>Iron Teeth 1-1 Plains 256x256</button>\n            <button className=\"btn btn-link\" onClick={(e) => loadExample(\"lets-play-plains.json\", exmapleLetsPlay)}>Lets Play Plains 256x256</button>\n          </div>\n        </div>\n        <div className=\"p-2 text-center\">\n          <small className=\"form-text\">\n            This editor is made by <a href=\"https://bonaroo.nl/\" rel=\"noreferrer\" target=\"_blank\">Charper Bonaroo BV</a> and is not officially\n            supported by Timberborn. Charper Bonaroo BV is not affiliated with Mechanistry.\n            <br />\n            <br />\n            <a className=\"btn btn-sm btn-link\" rel=\"noreferrer\" href=\"https://github.com/charperbonaroo/timberborn-save-editor\" target=\"_blank\">Github</a>\n            {\" \"}\n            <a className=\"btn btn-sm btn-link\" href=\"mailto:toby@bonaroo.nl\">Contact</a>\n            {\" \"}\n            <span className=\"btn-sm\" style={{display: \"inline-block\", lineHeight: \"1.5\", verticalAlign: \"middle\"}}>Discord: <b>gamebuster800#2213</b></span>\n          </small>\n        </div>\n      </div>\n    </div>\n  </div>\n}\n","import { DemoSave } from \"./DemoSave\";\n\nexport function Navbar({ saveData, onHome }: { saveData?: DemoSave, onHome: () => void }) {\n  return <nav className=\"navbar navbar-light bg-light\">\n    <div className=\"container\">\n    {// eslint-disable-next-line\n    }<a href=\"#\" onClick={(e) => { e.preventDefault(); onHome(); }} className=\"navbar-brand\">Timberborn Save Editor</a>\n    </div>\n  </nav>\n}\n","/*eslint-disable*/\n\n/**\n * Fast UUID generator, RFC4122 version 4 compliant.\n * @author Jeff Ward (jcward.com).\n * @license MIT license\n * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\n **/\n\nconst lut: string[] = [];\nfor (var i=0; i<256; i++) { lut[i] = (i<16?'0':'')+(i).toString(16); }\n\nexport function UUID() {\n  var d0 = Math.random()*0xffffffff|0;\n  var d1 = Math.random()*0xffffffff|0;\n  var d2 = Math.random()*0xffffffff|0;\n  var d3 = Math.random()*0xffffffff|0;\n  return lut[d0&0xff]+lut[d0>>8&0xff]+lut[d0>>16&0xff]+lut[d0>>24&0xff]+'-'+\n    lut[d1&0xff]+lut[d1>>8&0xff]+'-'+lut[d1>>16&0x0f|0x40]+lut[d1>>24&0xff]+'-'+\n    lut[d2&0x3f|0x80]+lut[d2>>8&0xff]+'-'+lut[d2>>16&0xff]+lut[d2>>24&0xff]+\n    lut[d3&0xff]+lut[d3>>8&0xff]+lut[d3>>16&0xff]+lut[d3>>24&0xff];\n}\n","import { createContext } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\n\nexport const SaveContext = createContext<{ saveData: DemoSave }>(undefined as any);\n","import { sample } from \"lodash\";\nimport { DemoSave, UnknownEntity } from \"./DemoSave\";\nimport { UUID } from \"./util/UUID\";\n\nexport const BeaverUtil = {\n  setAge(saveData: DemoSave, beaver: UnknownEntity, age: number) {\n    const dayNumber = saveData.Singletons.DayNightCycle.DayNumber;\n    (beaver.Components.Beaver as any).DayOfBirth = Math.floor(dayNumber - age);\n  },\n\n  /**\n   * Set the default needs for a beaver\n   * @param beaver\n   */\n  setDefaultNeeds(beaver: UnknownEntity): void {\n    beaver.Components.MortalNeeder = { DeathDays: [] };\n    for (const need of (beaver.Components.NeedManager as any).Needs) {\n      if ([\"Hunger\", \"Thirst\", \"Sleep\"].includes(need.Name)) {\n        need.Points = 1.0;\n      }\n    }\n  },\n\n  setDefaultName(saveData: DemoSave, beaver: UnknownEntity): void {\n    const names = saveData.Singletons.NameService.Names;\n    (beaver.Components.Beaver as any).Name = sample(names);\n  },\n\n  reset(beaver: UnknownEntity) {\n    beaver.Id = UUID();\n    BeaverUtil.setDefaultNeeds(beaver);\n    Object.assign(beaver.Components, {\n      BehaviorManager: {\n        RunningBehaviorId: \"HomelessRootBehavior\",\n        RunningBehaviorOwner: beaver.Id,\n        ReturnToBehavior: false,\n        TimestampedBehaviorLog: [\n          \"HomelessRootBehavior 1.00\"\n        ]\n      },\n      Dweller: {},\n      Worker: {},\n    });\n  }\n}\n","import { sample, sortBy } from \"lodash\";\nimport { useCallback, useState } from \"react\";\nimport { BeaverUtil } from \"../BeaverUtil\";\nimport { deepCopy } from \"../deepCopy\";\nimport { DemoSave, DemoSaveEntity, UnknownEntity } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\nexport const BeaverCopier: IEditorPlugin<DemoSave, DemoSave> = {\n  id: \"BeaverCopier\",\n  name: \"Beaver copier\",\n  group: \"Beavers\",\n  position: 1,\n  enabled: true,\n\n  read(saveData) {\n    return saveData;\n  },\n\n  write(saveData, data) {\n    return data;\n  },\n\n  Preview({ saveData }) {\n    return <BeaverStatus entities={saveData.Entities} />;\n  },\n\n  Editor({ initialData, onClose, onSubmit }) {\n    const [ beavers, setBeavers ] = useState(() => initialData.Entities.filter(_ => _.Template === \"BeaverChild\" || _.Template === \"BeaverAdult\"))\n    const [ page, setPage ] = useState(0);\n    const [ pageSize, setPageSize ] = useState(25);\n    const [ targetAmount, setTargetAmount ] = useState(70);\n\n    const sortedBeavers = sortBy(beavers.slice(), _ => -(_ as any).Components.Beaver.DayOfBirth);\n\n    const offset = page * pageSize;\n\n    const copyBeaver = useCallback((beaver: UnknownEntity) => {\n      const newBeaver = deepCopy(beaver);\n      BeaverUtil.reset(newBeaver);\n      BeaverUtil.setDefaultName(initialData, newBeaver);\n      if (newBeaver.Template === \"BeaverAdult\") {\n        BeaverUtil.setAge(initialData, beaver, 5)\n      }\n      return newBeaver;\n    }, [initialData]);\n\n    const duplicate = useCallback((beaver: UnknownEntity) => {\n      setBeavers(beavers.slice().concat([copyBeaver(beaver)]));\n    }, [beavers, setBeavers, copyBeaver]);\n\n    const doSubmit = useCallback(() => {\n      const Entities = initialData.Entities\n        .filter(_ => _.Template !== \"BeaverChild\" && _.Template !== \"BeaverAdult\")\n        .concat(beavers);\n\n      onSubmit({ ...initialData, Entities });\n    }, [onSubmit, beavers, initialData]);\n\n    const hasNextPage = pageSize + offset < beavers.length;\n\n    const doSetBeaverCount = useCallback(() => {\n      const adults = beavers.filter(_ => _.Template === \"BeaverAdult\");\n      const newBeavers = beavers.slice();\n      for (const beaver of newBeavers) {\n        BeaverUtil.setDefaultNeeds(beaver);\n      }\n      while (newBeavers.length < targetAmount) {\n        newBeavers.push(copyBeaver(sample(adults)!));\n      }\n      setBeavers(newBeavers);\n    }, [beavers, targetAmount, copyBeaver]);\n\n    return <div className=\"container my-4\">\n      <div className=\"card\">\n        <div className=\"card-body\">\n          <h1 className=\"card-title\">Beaver Copier</h1>\n          <div className=\"d-flex\">\n            <div>\n              <BeaverStatus entities={beavers} />\n            </div>\n            <div className=\"ms-auto\">\n              <button type=\"button\" onClick={onClose} className=\"btn btn-light\">Discard changes</button>\n              {\" \"}\n              <button type=\"button\" onClick={doSubmit} className=\"btn btn-primary\">Submit</button>\n            </div>\n          </div>\n        </div>\n        <table className=\"table my-0\">\n          <thead>\n            <tr>\n              <th>Name</th>\n              <th>Age <small style={{fontWeight: \"normal\"}}>a-z</small></th>\n              <th>Coordinates</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>\n            {sortedBeavers.slice(offset, offset + pageSize).map((beaver: any) => <tr key={beaver.Id}>\n              <td>{beaver.Components.Beaver.Name}</td>\n              <td>{initialData.Singletons.DayNightCycle.DayNumber - beaver.Components.Beaver.DayOfBirth} {beaver.Template === \"BeaverChild\" ? <small>(child)</small> : null}</td>\n              <td>\n                x: <b>{Math.round(beaver.Components.Beaver.Position.X)}</b>{\" \"}\n                y: <b>{Math.round(beaver.Components.Beaver.Position.Y)}</b>{\" \"}\n                z: <b>{Math.round(beaver.Components.Beaver.Position.Z)}</b>{\" \"}\n              </td>\n              <td className=\"text-end py-1\">\n                <button type=\"button\" className=\"btn btn-light btn-sm\" onClick={() => duplicate(beaver)}>Copy</button>\n              </td>\n            </tr>)}\n          </tbody>\n          <tfoot>\n            <tr>\n              <td colSpan={4} className=\"py-1\">\n                <div className=\"d-flex\">\n                  <div className=\"me-auto\">\n                    Showing <strong>{offset}</strong> - <strong>{Math.min(beavers.length, offset + pageSize)}</strong> of <strong>{beavers.length}</strong>\n                  </div>\n                  <form className=\"me-3 d-flex\" onSubmit={(event) => { event.preventDefault(); doSetBeaverCount(); }}>\n                    <label className=\"form-label me-1 mt-1 mb-0\" htmlFor=\"addRandom\">Set beavers</label>\n                    <input type=\"number\" id=\"addRandom\" className=\"form-control form-control-sm\" value={targetAmount}\n                      onChange={(event) => { setTargetAmount(parseInt(event.target.value, 10)) }} width={3} style={{width: 80}} />\n                    <button type=\"submit\" className=\"ms-1 btn btn-primary btn-sm\">Set</button>\n                  </form>\n                  <div className=\"me-3 d-flex\">\n                    <label className=\"form-label me-1 mt-1 mb-0\" htmlFor=\"pageSize\">Pagesize</label>\n                    <select id=\"pageSize\" className=\"form-control form-control-sm\" value={pageSize} onChange={(event) => { setPage(0); setPageSize(parseInt(event.target.value, 10)) }}>\n                      <option>10</option>\n                      <option>25</option>\n                      <option>100</option>\n                      <option>250</option>\n                      <option>1000</option>\n                      <option value={`${Number.MAX_SAFE_INTEGER}`}>ALL</option>\n                    </select>\n                  </div>\n                  <div>\n                    <button className=\"btn btn-sm btn-light\" disabled={page<=0} onClick={() => setPage(page-1)}>&lsaquo; prev</button>\n                    {\" \"}\n                    <button className=\"btn btn-sm btn-light\" disabled={!hasNextPage} onClick={() => setPage(page+1)}>next &rsaquo;</button>\n                  </div>\n                </div>\n              </td>\n            </tr>\n          </tfoot>\n        </table>\n      </div>\n    </div>;\n  }\n}\n\nfunction BeaverStatus({entities}: {entities: DemoSaveEntity[]}) {\n  const {adultCount, childCount} = entities.reduce((acc, entity) => {\n    if (entity.Template === \"BeaverAdult\") {\n      acc.adultCount++;\n    }\n    if (entity.Template === \"BeaverChild\") {\n      acc.childCount++;\n    }\n    return acc;\n  }, { adultCount: 0, childCount: 0 })\n\n  const sum = adultCount+childCount;\n\n  return <span>You have <strong>{sum}</strong> beavers: <strong>{childCount}</strong> kits and <strong>{adultCount}</strong> adults.</span>;\n\n}\n","import { useMemo, useState } from \"react\";\nimport { DemoSave } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\nexport const DownloadPlugin: IEditorPlugin<DemoSave, DemoSave> = {\n  id: \"DownloadPlugin\",\n  name: \"Download\",\n  group: \"General\",\n  position: -Infinity,\n  enabled: true,\n\n  read(saveData) {\n    return saveData;\n  },\n\n  write(saveData, data) {\n    throw new Error(`Not implemented`);\n  },\n\n  Preview({ saveData }) {\n    return <strong>Click here to download your modified save!</strong>;\n  },\n\n  Editor({ initialData: saveData, onClose }) {\n\n    saveData = {\n      ...saveData,\n      GameVersion: saveData.GameVersion.replace(/-TSE$/, \"\") + \"-TSE\",\n      Editor: \"https://charperbonaroo.github.io/timberborn-save-editor/\",\n    }\n\n    const blob = useMemo(() => new Blob([JSON.stringify(saveData)], {type: 'application/json'}), [saveData]);\n    const url = URL.createObjectURL(blob);\n\n\n    const [filename, setFilename] = useState<string>(() => {\n      const now = new Date();\n      return `${saveData.__originalFilename.replace(\".json\", \"\")} MODDED ${now.toISOString().substr(0, 10)} ${now.getHours()}h${now.getMinutes()}m.json`;\n    });\n\n    return <div className=\"container\">\n      <div className=\"card my-4\">\n        <div className=\"card-body\">\n          <h1 className=\"card-title\">Download</h1>\n          <div className=\"my-3\">\n            <label htmlFor=\"filename\" className=\"form-label\">Filename</label>\n            <input type=\"text\" value={filename} onChange={(e) => setFilename(e.target.value)} id=\"filename\" className=\"form-control\" />\n          </div>\n          <div className=\"my-3 alert alert-warning\">\n            <strong>Warning:</strong> The <em>Timberborn Save Editor</em> is <strong>not\n            officially supported</strong> by Timberborn.\n            <br />\n            Savefiles generated by this tool can <strong>crash your game</strong>, <strong>cause bugs</strong>, or other <strong>weird stuff</strong>.\n            <br />\n            Some bugs, crashes or weird stuff might not be immediately clear and only be noticable later into your game.\n            <br />\n            <br />\n            If you encounter issues with the game after loading a savefile created by this tool,\n            please create a bug report <a href=\"https://github.com/charperbonaroo/timberborn-save-editor/issues\" target=\"_blank\" rel=\"noreferrer\">here</a> or\n            contact <a href=\"mailto:toby@bonaroo.nl\">me</a> directly.\n            <br />\n            <br />\n            If you accept these risks, use the Download button below. Enjoy the game!\n          </div>\n          <div className=\"d-flex\">\n            <a href={url} download={filename.endsWith(\".json\") ? filename : filename + \".json\"} className=\"btn btn-primary\" onClick={() => onClose()}>Download</a>\n            <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Close</button>\n          </div>\n          <small className=\"form-text\">\n            Store your savefile in: <code>%USERPROFILE%\\Documents\\Timberborn\\Saves\\</code>\n          </small>\n        </div>\n      </div>\n    </div>;\n  }\n}\n","import { DemoSave, UnknownEntity } from \"./DemoSave\";\n\ninterface StockpileGoodsEntry {\n  Good: { Id: string };\n  Amount: number;\n}\n\nconst stockpileTypes = [{\n  id: \"LargeWaterTank.Folktails\",\n  capacity: 300\n}, {\n  id: \"SmallWaterTank.Folktails\",\n  capacity: 30\n}, {\n  id: \"SmallWarehouse.Folktails\",\n  capacity: 200,\n}, {\n  id: \"LogPile.Folktails\",\n  capacity: 180,\n}, {\n  id: \"UndergroundWarehouse.Folktails\",\n  capacity: 4000,\n}, {\n  id: \"LargeWarehouse.Folktails\",\n  capacity: 1000,\n}, {\n  id: \"SmallWarehouse.IronTeeth\",\n  capacity: 200,\n}, {\n  id: \"SmallWaterTank.IronTeeth\",\n  capacity: 30,\n}, {\n  id: \"LargeWaterTank.IronTeeth\",\n  capacity: 300,\n}, {\n  id: \"IndustrialLogPile.IronTeeth\",\n  capacity: 180,\n}, {\n  id: \"LargeWarehouse.IronTeeth\",\n  capacity: 1000,\n}];\n\nconst stockpileIds = stockpileTypes.map(_ => _.id)\n\nexport const StockpileUtil = {\n  stockpileTypes,\n  getCapacity: (stockpile: UnknownEntity) => stockpileTypes.find(_ => _.id === stockpile.Template)?.capacity,\n  getStockpiles: (saveData: DemoSave) => saveData.Entities.filter(_ => stockpileIds.includes(_.Template)),\n  countGoods: (stockpile: UnknownEntity, accumulator = {} as Record<string, number>) => (((stockpile.Components[\"Inventory:Stockpile\"] as any)?.Storage?.Goods || []) as StockpileGoodsEntry[])\n    .reduce((acc, { Good, Amount }) => ({ ...acc, [Good.Id]: Amount + (acc[Good.Id] || 0) }), accumulator)\n}\n","import { BeaverAdultEntity, DemoSave, UnknownEntity } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\nimport { Canvas } from '@react-three/fiber'\nimport { FormEvent, useCallback, useLayoutEffect, useMemo, useRef, useState } from \"react\";\nimport lodash, { compact, get, set, toPairs, uniq } from \"lodash\";\nimport { MapControls } from \"@react-three/drei\";\nimport './MapPlugin.scss';\nimport { Navbar } from \"../Navbar\";\nimport { BoxBufferGeometry, BufferGeometry, ConeBufferGeometry, CylinderBufferGeometry, Mesh, MeshStandardMaterial, PlaneBufferGeometry } from \"three\";\nimport { EffectComposer, SSAO as _SSAO } from \"@react-three/postprocessing\";\nimport { deepCopy } from \"../deepCopy\";\nimport { StockpileUtil } from \"../StockpileUtil\";\n\nconst SSAO = _SSAO as any;\nconst { BlendFunction } = require(\"postprocessing\") as any;\nconst BufferGeometryUtils = require('three/examples/jsm/utils/BufferGeometryUtils.js') as any;\n\ninterface State {\n  saveData: DemoSave;\n  mapData: MapData;\n  entityData: EntityData;\n}\n\ninterface MutableState extends State {\n  setEntity: (entity: UnknownEntity) => void;\n  selectEntityId: (id: string|null) => void;\n  selectedEntity: UnknownEntity|null;\n}\n\ninterface MapData {\n  i2x: (i: number) => number,\n  i2y: (i: number) => number,\n  i2xy: (i: number) => [number, number],\n  i2xyz: (i: number, y: number) => [number, number, number],\n  heightMap: Uint8Array;\n  waterDepthMap: Float32Array;\n  moistureMap: Float32Array;\n  mapSizeX: number;\n  mapSizeY: number;\n}\n\ninterface EntityData {\n  deleteIds: string[];\n  updateIds: string[];\n  entitiesByIds: Record<string, UnknownEntity>;\n  entitiesIdsByTemplate: Record<string, string[]>;\n}\n\nconst STOCKPILE_ENTITIES = StockpileUtil.stockpileTypes.map(_ => _.id);\nconst TREE_ENTITIES = [\n  \"Maple\",\n  \"Pine\",\n  \"Birch\",\n]\n\nconst BEAVER_ENTITIES = [\n  \"BeaverAdult\",\n  \"BeaverChild\",\n]\n\nconst PATH_ENTITIES = [\n  \"Path.Folktails\",\n  \"Path.IronTeeth\",\n  \"Slope\",\n  \"WoodenStairs.Folktails\",\n  \"WoodenStairs.IronTeeth\",\n  \"DistrictGate.Folktails\",\n  \"DistrictGate.IronTeeth\",\n]\n\nconst PLATFORM_ENTITIES = [\n  \"Platform.Folktails\",\n  \"Platform.IronTeeth\",\n  \"DoublePlatform.Folktails\",\n  \"DoublePlatform.IronTeeth\",\n  \"TriplePlatform.Folktails\",\n  \"TriplePlatform.IronTeeth\",\n]\n\nconst EDITABLE_ENTITIES = [\n  ...STOCKPILE_ENTITIES, ...TREE_ENTITIES, ...BEAVER_ENTITIES, ...PATH_ENTITIES,\n  ...PLATFORM_ENTITIES,\n];\n\nconst useEntitiesOfTypes = (entityData: EntityData, templateIds: string[]) => {\n  const {entitiesIdsByTemplate, entitiesByIds} = entityData;\n  return useMemo(() => lodash(templateIds)\n    .map(_ => entitiesIdsByTemplate[_])\n    .flatten()\n    .map((id) => entitiesByIds[id])\n    .compact()\n    .toJSON(), [templateIds, entitiesIdsByTemplate, entitiesByIds]);\n}\n\nfunction readEntityData(saveData: DemoSave) {\n  return lodash(saveData.Entities)\n    .filter(_ => EDITABLE_ENTITIES.includes(_.Template))\n    .reduce((acc, entity) => {\n      acc.entitiesByIds[entity.Id] = entity;\n      if (!acc.entitiesIdsByTemplate[entity.Template]) {\n        acc.entitiesIdsByTemplate[entity.Template] = [];\n      }\n      acc.entitiesIdsByTemplate[entity.Template].push(entity.Id);\n      return acc;\n    }, {\n      deleteIds: [],\n      updateIds: [],\n      entitiesByIds: {},\n      entitiesIdsByTemplate: {}\n    } as EntityData)\n}\n\nfunction readMapData(saveData: DemoSave) {\n  const {Singletons} = saveData;\n  const mapSizeX = Singletons.MapSize.Size.X;\n  const mapSizeY = Singletons.MapSize.Size.Y;\n\n  return {\n    i2x: (index: number) => index % mapSizeY,\n    i2y: (index: number) => Math.floor(index / mapSizeY),\n    i2xy: (index: number) => [index % mapSizeY, Math.floor(index / mapSizeY)] as [number, number],\n    i2xyz: (index: number, y: number) => [index % mapSizeY, y, Math.floor(index / mapSizeY)] as [number, number, number],\n    mapSizeX,\n    mapSizeY,\n    heightMap: Uint8Array.from(Singletons.TerrainMap.Heights.Array.split(\" \").map(_ => parseInt(_, 10))),\n    moistureMap: Float32Array.from(Singletons.SoilMoistureSimulator.MoistureLevels.Array.split(\" \").map(_ => parseFloat(_))),\n    waterDepthMap: Float32Array.from(Singletons.WaterMap.WaterDepths.Array.split(\" \").map(_ => parseFloat(_))),\n  }\n}\n\n\nexport const MapPlugin: IEditorPlugin<State, State> = {\n  id: \"MapPlugin\",\n  name: \"Map\",\n  position: 2,\n  group: \"General\",\n  enabled: true,\n\n  read: (saveData) => ({\n    mapData: readMapData(saveData),\n    entityData: readEntityData(saveData),\n    saveData\n  }),\n\n  write: (saveData, state) => {\n    return {\n      ...saveData,\n      Entities: compact(saveData.Entities.map((entity) => {\n        if (state.entityData.deleteIds.includes(entity.Id)) {\n          return null;\n        } else if (state.entityData.updateIds.includes(entity.Id)) {\n          return state.entityData.entitiesByIds[entity.Id];\n        } else {\n          return entity;\n        }\n      }))\n    }\n  },\n\n  Preview: ({ saveData }) => <div>\n    An interactive 3D Map that will take a while to load.\n  </div>,\n\n  Editor: ({ initialData, onSubmit, onClose }) => {\n    const [state, setState] = useState(initialData);\n    const [selectedEntityId, setSelectedEntityId] = useState<string|null>(null);\n    const selectedEntity = (selectedEntityId && state.entityData.entitiesByIds[selectedEntityId]) || null;\n    const {mapSizeX, mapSizeY} = state.mapData;\n\n    const setEntity = (entity: UnknownEntity) => {\n      const oldEntity: UnknownEntity|undefined = state.entityData.entitiesByIds[entity.Id];\n      const newState = {\n        ...state,\n        entityData: {\n          ...state.entityData,\n          updateIds: uniq(state.entityData.updateIds.concat([entity.Id])),\n          entitiesByIds: {\n            ...state.entityData.entitiesByIds,\n            [entity.Id]: entity,\n          },\n        }\n      }\n\n      if (!oldEntity || oldEntity.Template !== entity.Template) {\n        newState.entityData.entitiesIdsByTemplate = {\n          ...newState.entityData.entitiesIdsByTemplate,\n          [oldEntity.Template]: (newState.entityData.entitiesIdsByTemplate[oldEntity.Template] || [])\n            .filter(_ => !oldEntity || (oldEntity && _ !== oldEntity.Id)),\n          [entity.Template]: [...newState.entityData.entitiesIdsByTemplate[entity.Template], entity.Id]\n        };\n      }\n\n      setState(newState);\n    }\n\n    const selectEntityId = useCallback((id: string|null) => {\n      if (selectedEntityId && id) {\n        return;\n      }\n      setSelectedEntityId(id);\n    }, [selectedEntityId, setSelectedEntityId])\n\n    return <div className=\"Map__Editor\">\n      <Navbar onHome={onClose} />\n      <Gui {...state} onSubmit={onSubmit} onClose={onClose} selectEntityId={selectEntityId} selectedEntity={selectedEntity} setEntity={setEntity} />\n\n      <Canvas className=\"Map__Canvas\" camera={{position: [32, 64, -64]}}>\n        <EffectComposer>\n          <SSAO\n            blendFunction={BlendFunction.MULTIPLY}\n            samples={50}\n            radius={2}\n            intensity={30}\n          />\n        </EffectComposer>\n        <axesHelper position={[0, 8, 0]} scale={[4, 4, 4]} />\n        <ambientLight intensity={0.3} />\n        <directionalLight position={[10, 10, 10]} intensity={0.4} />\n        <group scale={[1, 1, -1]}>\n          <group position={[mapSizeX/-2, 0, mapSizeY/-2]}>\n            <SlowBoxesHeightMap {...state} />\n            <SlowBoxesWaterMap {...state} />\n            <TreesMap {...state} />\n            <PlatformsMap {...state} />\n            <PathsMap {...state} />\n            <StockpilesMap {...state} selectEntityId={selectEntityId} selectedEntity={selectedEntity} setEntity={setEntity} />\n            <BeaversMap {...state} selectEntityId={selectEntityId} selectedEntity={selectedEntity} setEntity={setEntity} />\n          </group>\n        </group>\n        <MapControls />\n      </Canvas>\n    </div>;\n  }\n}\n\ninterface GuiProps extends MutableState {\n  onSubmit: (state: State) => void;\n  onClose: () => void;\n}\n\nfunction Gui(state: GuiProps) {\n  if (!state.selectedEntity) {\n    return <div className=\"Map__Gui\">\n    <div className=\"Map__Gui__Right p-4\">\n      <div className=\"card\">\n        <div className=\"card-body\">\n          <h4 className=\"card-title\">Map Editor</h4>\n          <p>A 3D view of the map. Red bars are beavers. Red boxes are warehouses. Click a red thing to edit. Use mouse to navigate camera.</p>\n          <button className=\"btn btn-primary btn-sm\" onClick={() => state.onSubmit(state)}>Save</button>\n          {\" \"}\n          <button className=\"btn btn-light btn-sm\" onClick={() => state.onClose()}>Discard changes</button>\n        </div>\n      </div>\n    </div>\n  </div>;\n  }\n\n  return <div className=\"Map__Gui\">\n    <div className=\"Map__Gui__Right p-4\">\n      <div className=\"card\">\n        <div className=\"card-body\">\n          <h4 className=\"card-title\">{state.selectedEntity.Template}</h4>\n          {STOCKPILE_ENTITIES.includes(state.selectedEntity.Template) ? <StockpileForm {...state} /> : null}\n          {BEAVER_ENTITIES.includes(state.selectedEntity.Template) ? <BeaverForm {...state} /> : null}\n        </div>\n      </div>\n    </div>\n  </div>;\n}\n\nfunction BeaverForm({ selectedEntity, selectEntityId, setEntity }: MutableState) {\n  const [beaver, setBeaver] = useState<BeaverAdultEntity>(selectedEntity as any);\n\n  const getValue = (path: (string|number)[]) => get(beaver, path);\n  const setValue = (path: (string|number)[], format: (val: string) => any = (x) => x) => (event: FormEvent) => setBeaver(set(deepCopy(beaver), path, format((event.target as any).value)))\n\n  return <form onSubmit={(e) => { e.preventDefault(); setEntity(beaver); selectEntityId(null); }}>\n    <div className=\"mb-1 row\">\n      <label htmlFor=\"name\" className=\"col-sm-4 col-form-label col-form-label-sm\">Name</label>\n      <div className=\"col-sm-8\">\n        <input type=\"text\" id=\"name\" className=\"form-control form-control-sm\" value={getValue([\"Components\", \"Beaver\", \"Name\"])} onChange={setValue([\"Components\", \"Beaver\", \"Name\"])} />\n      </div>\n    </div>\n\n    {beaver.Components.NeedManager.Needs.map((need, index) => <div className=\"mb-1 row\" key={index}>\n      <label htmlFor={\"need-\" + index} className=\"col-sm-4 col-form-label col-form-label-sm\">{need.Name}</label>\n      <div className=\"col-sm-8\">\n        <input type=\"range\" min=\"0\" max=\"1\" step=\"0.001\" id={\"need-\" + index} className=\"form-control\"\n          value={getValue([\"Components\", \"NeedManager\", \"Needs\", index, \"Points\"])}\n          onChange={setValue([\"Components\", \"NeedManager\", \"Needs\", index, \"Points\"], (val) => parseFloat(val))} />\n      </div>\n    </div>)}\n\n    <div className=\"mt-2 row\">\n      <div className=\"col-sm-8 offset-sm-4\">\n        <button type=\"submit\" className=\"btn btn-secondary btn-sm\">OK</button>\n        {\" \"}\n        <button type=\"button\" onClick={() => selectEntityId(null)} className=\"btn btn-light btn-sm\">Discard</button>\n      </div>\n    </div>\n  </form>\n}\n\nfunction StockpilesMap({ entityData, selectEntityId, selectedEntity }: MutableState) {\n  const stockpiles = useEntitiesOfTypes(entityData, STOCKPILE_ENTITIES)\n\n  return <group>\n    {stockpiles.map((stockpile) => <Stockpile selected={selectedEntity === stockpile}\n      key={stockpile.Id} stockpile={stockpile} selectEntityId={selectEntityId} />)}\n  </group>\n}\n\nfunction Stockpile({ stockpile, selectEntityId, selected }: { selected: boolean, stockpile: UnknownEntity, selectEntityId: (id: string) => void }) {\n  const [isHover, setIsHover] = useState(false);\n\n  const onClick = () => { selectEntityId(stockpile.Id); }\n  const onPointerEnter = () => { setIsHover(true); }\n  const onPointerLeave = () => { setIsHover(false); }\n\n  const pos = (stockpile.Components as any).BlockObject.Coordinates;\n  const x: number = pos.X;\n  const y: number = pos.Z;\n  const z: number = pos.Y;\n\n  const meshRef = useRef<Mesh>();\n  const template = stockpile.Template;\n\n  useLayoutEffect(() => {\n    if (!meshRef.current) {\n      return;\n    }\n    let sizeX = 3;\n    let sizeY = 1;\n    let sizeZ = 2;\n    let geom: BufferGeometry|null = null;\n\n    if (/UndergroundWarehouse/.test(template)) {\n      sizeZ = 3;\n      sizeY = 3;\n    } else if (/Log/.test(template)) {\n      sizeZ = 3;\n      sizeY = 0.1;\n    } else if (/LargeWarehouse/.test(template)) {\n      sizeZ = 3;\n\n      geom = BufferGeometryUtils.mergeBufferGeometries([\n        new BoxBufferGeometry(sizeX, sizeY, sizeZ, 1.0, 1.0),\n        new BoxBufferGeometry(1, sizeY, sizeZ, 1.0, 1.0).translate(0, 1, 0),\n      ])\n    } else if (/LargeWaterTank/.test(template)) {\n      sizeY = 3\n      geom = BufferGeometryUtils.mergeBufferGeometries([\n        new CylinderBufferGeometry(1.0, 1.0, sizeY, 8, 8, false).translate(0.5, 0, 0),\n        new BoxBufferGeometry(2, 1, 1, 1.0, 1.0).translate(-0.5, -1, 0.5),\n      ])\n    }\n\n    if (!geom) {\n      geom = new BoxBufferGeometry(sizeX, sizeY, sizeZ, 1.0, 1.0);\n    }\n\n    if (isHover || selected) {\n      geom.scale(1.0 + 0.1 / sizeX, 1.0 + 0.1 / sizeY, 1.0 + 0.1 / sizeZ);\n    }\n\n    geom.translate(sizeX / 2 - 0.5, sizeY / 2, sizeZ / 2 - 0.5);\n    rotate(geom, stockpile);\n\n    meshRef.current.geometry = geom;\n  }, [stockpile, template, selected, isHover]);\n\n  return <mesh ref={meshRef} onPointerEnter={onPointerEnter} onPointerLeave={onPointerLeave} onClick={onClick} key={stockpile.Id} position={[x, y, z]}>\n    <meshStandardMaterial opacity={0.9} transparent color={selected ? \"#651FFF\" : (isHover ? \"#FF8A65\" : \"#E64A19\")} />\n  </mesh>;\n}\n\nfunction BeaversMap({ entityData, selectEntityId, selectedEntity }: MutableState) {\n  const beavers = useEntitiesOfTypes(entityData, BEAVER_ENTITIES)\n\n  return <group>\n    {beavers.map((beaver) => <Beaver selected={selectedEntity === beaver} key={beaver.Id}\n      beaver={beaver} selectEntityId={selectEntityId} />)}\n  </group>;\n}\n\nfunction Beaver({ beaver, selectEntityId, selected }: { selected: boolean, beaver: UnknownEntity, selectEntityId: (id: string) => void }) {\n  const [isHover, setIsHover] = useState(false);\n\n  const onClick = () => { selectEntityId(beaver.Id); }\n  const onPointerEnter = () => { setIsHover(true); }\n  const onPointerLeave = () => { setIsHover(false); }\n\n  const pos = (beaver.Components as any).Beaver.Position;\n  const isAdult = beaver.Template === \"BeaverAdult\";\n  const x: number = pos.X - 0.5;\n  const y: number = pos.Y + 0.1 + (isAdult ? 0.5 : 0.3);\n  const z: number = pos.Z - 0.5;\n  return <mesh onPointerEnter={onPointerEnter} onPointerLeave={onPointerLeave} onClick={onClick} key={beaver.Id} position={[x, y, z]}>\n    <meshStandardMaterial color={selected ? \"#651FFF\" : (isHover ? \"#FF8A65\" : \"#E64A19\")} />\n    <cylinderBufferGeometry args={[\n      (isHover || selected) ? 0.4 : 0.2,\n      (isHover || selected) ? 0.4 : 0.2,\n      (beaver.Template === \"BeaverAdult\" ? 1.0 : 0.6) * (isHover || selected ? 1.2 : 1.0),\n      8.0,\n      1.0,\n    ]} />\n  </mesh>;\n}\n\nfunction StockpileForm({ selectedEntity, selectEntityId, setEntity }: MutableState) {\n  const goodIds = useMemo(() => (selectedEntity as any).Components.GoodDesirer.DesiredGoods.map((_: any) => _.Good.Id), [selectedEntity]) as string[];\n  const [countGoods, setCountGoods] = useState<Record<string, number>>(() => StockpileUtil.countGoods(selectedEntity!, {}));\n  const capacity = StockpileUtil.getCapacity(selectedEntity!)!;\n  const totalCounts = Object.values(countGoods).reduce((a, b) => a + b, 0);\n\n  const doSubmit = useCallback((event: FormEvent) => {\n    event.preventDefault();\n    const newEntity = deepCopy(selectedEntity) as any;\n    newEntity.Components[\"Inventory:Stockpile\"] = { Storage: { Goods: toPairs(countGoods).map(([Id, Amount]) => ({ Good: {Id}, Amount })) } };\n    setEntity(newEntity);\n    selectEntityId(null);\n  }, [countGoods, selectEntityId, setEntity, selectedEntity]);\n\n  return <form onSubmit={doSubmit}>\n    {goodIds.map((goodId) => <div className=\"mb-1 row\" key={goodId}>\n      <label htmlFor={\"good-\" + goodId} className=\"col-sm-4 col-form-label col-form-label-sm\">{goodId}</label>\n      <div className=\"col-sm-8\">\n        <input type=\"number\" id={\"good-\" + goodId} className=\"form-control form-control-sm\" value={countGoods[goodId] || 0}\n          onChange={(event) => setCountGoods({ ...countGoods, [goodId]: event.target.valueAsNumber || 0 })} />\n      </div>\n    </div>)}\n\n    <div className=\"mt-2 row\">\n      <div className=\"col-sm-8 offset-sm-4\">\n        {totalCounts > capacity\n          ? <div className=\"text-danger p-1\">Warning: <strong>{totalCounts}</strong> storage exceeds capacity of <strong>{capacity}</strong>!</div>\n          : <div className=\"p-1\"><strong>{totalCounts}</strong> / <strong>{capacity}</strong></div>}\n\n        <button type=\"submit\" className=\"btn btn-secondary btn-sm\">OK</button>\n        {\" \"}\n        <button type=\"button\" onClick={() => selectEntityId(null)} className=\"btn btn-light btn-sm\">Discard</button>\n      </div>\n    </div>\n  </form>\n}\n\nfunction createTreeGeom({ dry, dead, adult, x, y, z }: {\n  entity: any;\n  dry: boolean;\n  dead: boolean;\n  adult: boolean;\n  x: number;\n  z: number;\n  y: number;\n}) {\n  return new ConeBufferGeometry((adult ? 0.4 : 0.2) * (dead ? 0.5 : 1.0), adult ? 2.0 : 0.5, 4.0, 4.0)\n    .translate(x, y + 0.5, z)\n}\n\nfunction meshWithColorFromGeoms(geometries: any[], color: string, opacity: number = 1.0) {\n  if (geometries.length === 0) {\n    return new Mesh();\n  }\n  const geom = BufferGeometryUtils.mergeBufferGeometries(geometries)\n  const mat = new MeshStandardMaterial({ color, opacity, transparent: opacity <= 0.99 });\n  return new Mesh(geom, mat);\n}\n\nfunction getEntityRotationY(entity: UnknownEntity): number {\n  const orientationMatch = (entity as any).Components.BlockObject.Orientation?.Value?.match(/Cw(\\d+)/);\n  if (orientationMatch) {\n    return parseFloat(orientationMatch[1]) / 180 * Math.PI;\n  } else {\n    return 0\n  }\n}\n\nfunction rotate(geom: BufferGeometry, entity: UnknownEntity) {\n  return geom.rotateY(getEntityRotationY(entity));\n}\n\nfunction PathsMap({ entityData }: State) {\n  const paths = useEntitiesOfTypes(entityData, PATH_ENTITIES);\n  const mesh = useMemo(() => meshWithColorFromGeoms(paths\n    .map((_: any) => {\n      let geom: BufferGeometry|null = null;\n      if (/Slope|Stairs/.test(_.Template)) {\n        geom = new PlaneBufferGeometry(1, 1.44, 1, 1).rotateX(-Math.PI/4).translate(0, 0.6, 0)\n        geom = rotate(geom, _);\n      } else if (/DistrictGate/.test(_.Template)) {\n        geom = BufferGeometryUtils.mergeBufferGeometries([\n          new PlaneBufferGeometry(1, 1, 1, 1).rotateX(-Math.PI/2).translate(0, 0.1, 0),\n          rotate(new BoxBufferGeometry(0.8, 1, 0.1, 1, 1, 1).translate(0, 0.5, 0), _),\n        ])\n      } else {\n        geom = new PlaneBufferGeometry(1, 1, 1, 1).rotateX(-Math.PI/2).translate(0, 0.1, 0)\n      }\n\n      return geom ? geom.translate(\n        _.Components.BlockObject.Coordinates.X,\n        _.Components.BlockObject.Coordinates.Z,\n        _.Components.BlockObject.Coordinates.Y\n      ) : null;\n    }).filter(_ => _), \"#BCAAA4\", 0.8), [paths]);\n\n  return <primitive object={mesh} />;\n}\n\nfunction PlatformsMap({ entityData }: State) {\n  const paths = useEntitiesOfTypes(entityData, PLATFORM_ENTITIES);\n  const geom = useMemo(() => meshWithColorFromGeoms(paths\n    .map((_: any) => {\n      let geom: BufferGeometry|null = null;\n      let height = 1;\n      if (/DoublePlatform/.test(_.Template)) {\n        height = 2;\n      } else if (/TriplePlatform/.test(_.Template)) {\n        height = 3;\n      }\n      height -= 0.05;\n      geom = BufferGeometryUtils.mergeBufferGeometries([\n        new BoxBufferGeometry(0.1, height, 0.1, 1, 1, 1).translate(-0.4, height / 2, -0.4),\n        new BoxBufferGeometry(0.1, height, 0.1, 1, 1, 1).translate( 0.4, height / 2,  0.4),\n        new BoxBufferGeometry(0.1, height, 0.1, 1, 1, 1).translate( 0.4, height / 2, -0.4),\n        new BoxBufferGeometry(0.1, height, 0.1, 1, 1, 1).translate(-0.4, height / 2,  0.4),\n        new BoxBufferGeometry(0.95, 0.05, 0.95, 1, 1, 1).translate(0, height + 0.025, 0),\n      ]);\n\n      return geom ? geom.translate(\n        _.Components.BlockObject.Coordinates.X,\n        _.Components.BlockObject.Coordinates.Z,\n        _.Components.BlockObject.Coordinates.Y\n      ) : null;\n    }).filter(_ => _), \"#A1887F\"), [paths]);\n\n  return <primitive object={geom} />;\n}\n\nfunction TreesMap({ entityData }: State) {\n  const treeEntities = useEntitiesOfTypes(entityData, TREE_ENTITIES);\n\n  const {greenTrees, brownTrees} = useMemo(() => {\n    const trees = treeEntities.map((_: any) => ({\n        entity: _,\n        dry: _.Components.WateredNaturalResource.DryingProgress > 0.9999,\n        dead: false, // _.Components.LivingNaturalResource.IsDead as boolean,\n        adult: _.Components.Growable.GrowthProgress > 0.9999,\n        x: _.Components.BlockObject.Coordinates.X as number,\n        z: _.Components.BlockObject.Coordinates.Y as number,\n        y: _.Components.BlockObject.Coordinates.Z as number,\n      }));\n\n    const greenTrees = meshWithColorFromGeoms(\n      trees.filter(_ => !(_.dry || _.dead)).map(createTreeGeom), \"#388E3C\");\n    const brownTrees = meshWithColorFromGeoms(\n      trees.filter(_ => _.dry || _.dead).map(createTreeGeom), \"#5D4037\");\n\n    return {greenTrees, brownTrees}\n  }, [treeEntities]);\n\n  return <group>\n    <primitive object={greenTrees} />\n    <primitive object={brownTrees} />\n  </group>;\n}\n\nfunction SlowBoxesWaterMap({ mapData }: State) {\n  const {i2x, i2y, heightMap, waterDepthMap} = mapData;\n\n  const mesh = useMemo(() => {\n    const geoms = lodash(waterDepthMap).reduce((acc, y, i) => {\n      if (y > 0) {\n        acc.push(new PlaneBufferGeometry(1, 1, 1, 1)\n          .rotateX(-Math.PI/2)\n          .translate(i2x(i), y * 0.95 + 0.05 + heightMap[i], i2y(i)));\n      }\n      return acc;\n    }, [] as BufferGeometry[]);\n\n    return meshWithColorFromGeoms(geoms, \"#0044cc\", 0.8);\n  }, [i2x, i2y, heightMap, waterDepthMap])\n\n  return <primitive object={mesh} />;\n}\n\nfunction SlowBoxesHeightMap({ mapData }: State) {\n  const {heightMap, moistureMap, i2x, i2y} = mapData;\n  const {wetLand, dryLand} = useMemo(() => {\n    const {wetBoxes, dryBoxes} = lodash(heightMap)\n      .reduce((acc, height, index) => {\n        const isWet = moistureMap[index] > 0;\n        const box = new BoxBufferGeometry(1, height, 1, 1, 1, 1).translate(i2x(index), height / 2, i2y(index));\n        (isWet ? acc.wetBoxes : acc.dryBoxes).push(box);\n        return acc;\n      }, { wetBoxes: [] as BufferGeometry[], dryBoxes: [] as BufferGeometry[] })\n\n    return {\n      wetLand: meshWithColorFromGeoms(wetBoxes, \"#8BC34A\"),\n      dryLand: meshWithColorFromGeoms(dryBoxes, \"#795548\")\n    }\n  }, [i2x, i2y, heightMap, moistureMap])\n\n  return <group>\n    <primitive object={wetLand} />\n    <primitive object={dryLand} />\n  </group>;\n}\n","import { useState } from \"react\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\ninterface MapSizeParams {\n  x: number;\n  y: number;\n}\n\nexport const MapSizePlugin: IEditorPlugin<MapSizeParams, MapSizeParams> = {\n  id: \"MapSizePlugin\",\n  name: \"Map size\",\n  group: \"General\",\n  position: Infinity,\n  enabled: true,\n\n  read(saveData) {\n    const x = saveData.Singletons.MapSize.Size.X;\n    const y = saveData.Singletons.MapSize.Size.Y;\n    return { x, y };\n  },\n\n  write(saveData, data) {\n    saveData.Singletons.MapSize.Size.X = data.x;\n    saveData.Singletons.MapSize.Size.Y = data.y;\n    return saveData;\n  },\n\n  Preview({ saveData }) {\n    console.log(saveData.Entities.map(_ => _.Template).filter((_, i, arr) => arr.indexOf(_) === i))\n\n    const x = saveData.Singletons.MapSize.Size.X;\n    const y = saveData.Singletons.MapSize.Size.Y;\n    return <span>\n      <strong>{x}</strong> &times; <strong>{y}</strong>\n    </span>;\n  },\n\n  Editor({ initialData, onClose, onSubmit }) {\n    const [data, setData] = useState(initialData);\n\n    return <form onSubmit={(e) => { e.preventDefault(); onSubmit(data); }}>\n      <div className=\"container\">\n        <div className=\"card my-4\">\n          <div className=\"card-body\">\n            <h1 className=\"card-title\">Map size editor</h1>\n            <p>This is just a demo editor - changing this will likely break something.</p>\n            <div className=\"mb-3\">\n              <label htmlFor=\"x\" className=\"form-label\">X</label>\n              <input id=\"x\" type=\"number\" className=\"form-control\" value={data.x} onInput={(e) => setData({ ...data, x: parseInt((e.target as HTMLInputElement).value, 10) })} />\n            </div>\n            <div className=\"mb-3\">\n              <label htmlFor=\"y\" className=\"form-label\">Y</label>\n              <input id=\"y\" type=\"number\" className=\"form-control\" value={data.y} onInput={(e) => setData({ ...data, y: parseInt((e.target as HTMLInputElement).value, 10) })} />\n            </div>\n            <div className=\"d-flex\">\n              <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\n              <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Discard changes</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </form>;\n  }\n}\n","import { fromJS, Map } from \"immutable\";\nimport { get } from \"lodash\";\nimport { useState } from \"react\";\nimport { DemoSave } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\ntype Singletons = DemoSave[\"Singletons\"];\n\ninterface InputDef {\n  label: string;\n  path: Array<string|number>;\n  type: \"number\"|\"text\";\n  parse: (value: string) => any;\n  step?: string;\n}\n\ninterface HeaderDef {\n  label: string;\n  type: \"header\";\n}\n\ntype FieldDefinition = InputDef|HeaderDef;\n\nconst parseIntValue = (value: string) => parseInt(value, 10);\n\nconst fields: FieldDefinition[] = [{\n  label: \"Science\",\n  path: [\"ScienceService\", \"SciencePoints\"],\n  type: \"number\",\n  parse: parseIntValue,\n}, {\n  label: \"Cycle & Day\",\n  type: \"header\",\n}, {\n  label: \"Cycle\",\n  path: [\"WeatherService\", \"Cycle\"],\n  type: \"number\",\n  parse: parseIntValue,\n}, {\n  label: \"Cycle day\",\n  path: [\"WeatherService\", \"CycleDay\"],\n  type: \"number\",\n  parse: parseIntValue,\n}, {\n  label: \"Temperate weather duration\",\n  path: [\"WeatherService\", \"TemperateWeatherDuration\"],\n  type: \"number\",\n  parse: parseIntValue,\n}, {\n  label: \"Drought duration\",\n  path: [\"WeatherService\", \"DroughtDuration\"],\n  type: \"number\",\n  parse: parseIntValue,\n}, {\n  label: \"Weather Duration\",\n  type: \"header\",\n}, {\n  label: \"Min temperate weather duration\",\n  path: [\"WeatherDurationService\", \"MinTemperateWeatherDuration\"],\n  type: \"number\",\n  parse: parseIntValue,\n}, {\n  label: \"Max temperate weather duration\",\n  path: [\"WeatherDurationService\", \"MaxTemperateWeatherDuration\"],\n  type: \"number\",\n  parse: parseIntValue,\n}, {\n  label: \"Min drought duration\",\n  path: [\"WeatherDurationService\", \"MinDroughtDuration\"],\n  type: \"number\",\n  parse: parseIntValue,\n}, {\n  label: \"Max drought duration\",\n  path: [\"WeatherDurationService\", \"MaxDroughtDuration\"],\n  type: \"number\",\n  parse: parseIntValue,\n}, {\n  label: \"Handicap multiplier\",\n  path: [\"WeatherDurationService\", \"HandicapMultiplier\"],\n  type: \"number\",\n  parse: parseFloat,\n  step: \"0.1\",\n}, {\n  label: \"Handicap cycles\",\n  path: [\"WeatherDurationService\", \"HandicapCycles\"],\n  type: \"number\",\n  parse: parseIntValue,\n}];\n\n\nexport const PropertiesPlugin: IEditorPlugin<Singletons, Singletons> = {\n  read: (saveData) => saveData.Singletons,\n  write: (saveData, data) => ({ ...saveData, Singletons: data }),\n  position: 0,\n  id: \"PropertiesPlugin\",\n  name: \"Properties\",\n  group: \"General\",\n  enabled: true,\n  Preview: ({ saveData }) => {\n    return <div className=\"row\">\n      {(fields.filter((_) => _.type !== \"header\") as InputDef[])\n        .map((_) => <div className=\"col-4\" key={(_.path.join(\".\"))}>{_.label}: <strong>{get(saveData.Singletons, _.path)}</strong></div>)}\n    </div>;\n  },\n  Editor: ({ initialData, onClose, onSubmit }) => {\n    const [data, setData] = useState(fromJS(initialData) as Map<string, any>);\n\n    return <form onSubmit={(e) => { e.preventDefault(); onSubmit(data.toJS() as Singletons); }}>\n      <div className=\"container\">\n        <div className=\"card my-4\">\n          <div className=\"card-body\">\n            <h1 className=\"card-title\">Properties</h1>\n            <div className=\"row\">\n              {fields.map((field) => {\n                if (field.type === \"header\") {\n                  return <h5 key={field.label} className=\"mb-1 col-12\">{field.label}</h5>\n                } else {\n                  const { path, type, parse, label } = field;\n                  const id = path.join(\".\")\n                  return <div key={id} className=\"mb-3 col-4\">\n                    <label htmlFor={id} className=\"form-label form-label-sm\">{label}</label>\n                    <input id={id} type={type} className=\"form-control form-control-sm\"\n                      value={data.getIn(path) as string} step={field.step}\n                      onInput={(e) => setData(data.setIn(path, parse((e.target as HTMLInputElement).value)))} />\n                  </div>;\n                }\n              })}\n            </div>\n            <div className=\"d-flex\">\n              <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\n              <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Discard changes</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </form>;\n  }\n}\n","import { assign, chunk, fill, groupBy, map, mapValues, sum, toPairs, uniq, values } from \"lodash\";\nimport { FormEvent, Fragment, useCallback, useMemo, useState } from \"react\";\nimport { DemoSave, UnknownEntity } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\nimport { StockpileUtil } from \"../StockpileUtil\";\n\nexport const StockpilePlugin: IEditorPlugin<DemoSave, DemoSave> = {\n  id: \"StockpilePlugin\",\n  name: \"Manage stockpile inventories\",\n  group: \"Storage\",\n  position: 10,\n  enabled: true,\n\n  read: (save) => save,\n  write: (_, data) => data,\n\n  Preview: ({ saveData }) => {\n    console.log(uniq(saveData.Entities.filter((_) => _.Components[\"Inventory:Stockpile\"]).map(_ => _.Template)))\n    const stockpiles = useMemo(() => StockpileUtil.getStockpiles(saveData), [saveData]);\n    const allGoods = useMemo(() => stockpiles.reduce((acc, stockpile) => StockpileUtil.countGoods(stockpile, acc), {} as Record<string, number>), [stockpiles]);\n\n    return <div>\n      <StockpileInventoryTable counts={allGoods} />\n    </div>\n  },\n\n  Editor: ({ initialData, onClose, onSubmit }) => {\n    const [ stockpileId, setStockpileId ] = useState<string|null>(null);\n    const [ stockpiles, setStockpiles ] = useState(() => StockpileUtil.getStockpiles(initialData));\n\n    const setStockpile = useCallback((type: \"self\"|\"all\", stockpile: UnknownEntity) => {\n      setStockpiles(stockpiles.slice().map((_) => (type === \"all\" ? _.Template === stockpile.Template : _.Id === stockpile.Id) ? {\n        ..._,\n        Components: { ..._.Components, \"Inventory:Stockpile\": stockpile.Components[\"Inventory:Stockpile\"] }\n      } : _));\n      setStockpileId(null);\n    }, [setStockpiles, stockpiles, setStockpileId])\n\n    const doSubmit = useCallback(() => {\n      const mappedStockpiles = mapValues(groupBy(stockpiles, \"Id\"), (arr) => arr[0]);\n\n      onSubmit({\n        ...initialData,\n        Entities: initialData.Entities.map((_) => mappedStockpiles[_.Id] ? mappedStockpiles[_.Id] : _),\n      });\n    }, [onSubmit, initialData, stockpiles]);\n\n    return <div className=\"container my-4\">\n      <div className=\"card\">\n        <div className=\"card-body\">\n          <h1 className=\"card-title\">Manage stockpile inventories</h1>\n          <div className=\"d-flex\">\n            <button type=\"button\" className=\"btn btn-primary\" onClick={doSubmit}>Submit</button>\n            <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Discard changes</button>\n          </div>\n        </div>\n        <div className=\"list-group list-group-flush\">\n          {stockpiles.map((stockpile) => stockpileId === stockpile.Id\n            ? <StockpileForm key={stockpile.Id} setStockpile={setStockpile} stockpile={stockpile} />\n            : <StockpileButton key={stockpile.Id} setStockpileId={setStockpileId} stockpile={stockpile} />)}\n        </div>\n      </div>\n    </div>;\n  }\n}\n\nfunction StockpileForm({ stockpile, setStockpile }: { stockpile: UnknownEntity, setStockpile: (type: \"self\"|\"all\", stockpile: UnknownEntity) => void }) {\n  const goods: string[] = useMemo(() => (stockpile.Components.GoodDesirer as any).DesiredGoods.map((_: any) => _.Good.Id), [stockpile]);\n  const [ counts, setCounts ] = useState(() => StockpileUtil.countGoods(stockpile));\n\n  const onSubmit = useCallback((event: FormEvent) => {\n    event.preventDefault();\n    const type = (event.nativeEvent as SubmitEvent).submitter?.getAttribute(\"value\") === \"all\" ? \"all\" : \"self\";\n    setStockpile(type, {\n      ...stockpile,\n      Components: {\n        ...stockpile.Components,\n        \"Inventory:Stockpile\": {\n          Storage: {\n            Goods: toPairs(counts).filter(([k,v]) => v && v > 0).map(([Id, Amount]) => ({ Good: {Id}, Amount }))\n          }\n        }\n      }\n    })\n  }, [stockpile, setStockpile, counts]);\n\n\n  const setCount = useCallback((good: string, count: number) => {\n    setCounts({ ...counts, [good]: count });\n  }, [setCounts, counts]);\n\n  const totalCounts = sum(map(values(counts), _ => _ || 0));\n  const capacity = StockpileUtil.getCapacity(stockpile) ?? 0;\n\n  return <div className=\"list-group-item\">\n    <div className=\"d-flex\">\n      <div>\n        <b>{stockpile.Template}</b>\n        <div style={{whiteSpace: \"nowrap\"}}>\n          x: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.X)}</b>{\" \"}\n          y: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Y)}</b>{\" \"}\n          z: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Z)}</b>{\" \"}\n        </div>\n      </div>\n      <form className=\"flex-fill\" onSubmit={onSubmit}>\n        {goods.map((good) => <div key={good} className=\"row mb-3\">\n          <label className=\"col-sm-2 col-form-label col-form-label-sm text-end\">{good}</label>\n          <div className=\"col-sm-10\">\n            <input className=\"form-control form-control-sm\" type=\"number\"\n              onChange={(event) => { setCount(good, event.target.valueAsNumber ?? 0) }} value={counts[good] || \"\"} />\n          </div>\n        </div>)}\n        <div className=\"row\">\n          <div className=\"col-sm-10 offset-sm-2 d-flex\">\n            <button type=\"submit\" name=\"submit\" value=\"self\" className=\"btn btn-primary btn-sm\">OK</button>\n            {totalCounts > capacity\n              ? <div className=\"text-danger p-1\">Warning: <strong>{totalCounts}</strong> storage exceeds capacity of <strong>{capacity}</strong>!</div>\n              : <div className=\"p-1\"><strong>{totalCounts}</strong> / <strong>{capacity}</strong></div>}\n            <button type=\"submit\" name=\"submit\" value=\"all\" className=\"ms-auto btn btn-danger btn-sm\">OK &amp; update all</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n}\n\nfunction StockpileButton({ stockpile, setStockpileId }: { stockpile: UnknownEntity, setStockpileId: (id: string) => void }) {\n  return <button onClick={() => setStockpileId(stockpile.Id)} className=\"list-group-item list-group-item-action\">\n    <div className=\"d-flex\">\n      <div>\n        <b>{stockpile.Template}</b>\n        <div style={{whiteSpace: \"nowrap\"}}>\n          x: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.X)}</b>{\" \"}\n          y: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Y)}</b>{\" \"}\n          z: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Z)}</b>{\" \"}\n        </div>\n      </div>\n      <StockpileInventoryTable counts={StockpileUtil.countGoods(stockpile)} />\n    </div>\n  </button>;\n}\n\nfunction StockpileInventoryTable({ counts }: { counts: Record<string, number> }) {\n  return <table className=\"table table-sm table-borderless my-0\">\n    <tbody>\n      {chunk(toPairs(counts), 5).map((chunk, index) => <tr key={index}>\n        {assign(fill(new Array(5), [\"\", \"\"]), chunk).map(([label, value], i) => <Fragment key={i}>\n          <th style={{width: \"17%\"}} className=\"text-end\">{label}</th>\n          <td style={{width: \"3%\"}} className=\"text-end\">{value}</td>\n        </Fragment>)}\n      </tr>)}\n    </tbody>\n  </table>;\n}\n","import { sortBy } from \"lodash\";\nimport { IEditorPlugin } from \"./IEditorPlugin\";\nimport * as pluginsImport from \"./plugins\";\n\nexport const allPlugins: IEditorPlugin<any, any>[] = sortBy(Object\n  .values(pluginsImport)\n  .filter(_ => _ && typeof _ === \"object\"), \"position\");\n","import { useMemo } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\nimport { allPlugins } from \"./allPlugins\";\nimport { groupBy, toPairs } from \"lodash\";\n\nexport function PluginIndex({ saveData, onSelectPlugin }: { saveData: DemoSave, onSelectPlugin: (pluginId: string) => void }) {\n  const groupedPlugins = useMemo(() => toPairs(groupBy(allPlugins\n    .filter(_ => typeof _.enabled === \"function\" ? _.enabled({saveData}) : _.enabled), \"group\")), [saveData]);\n\n  return <div className=\"container\">\n    {groupedPlugins.map(([groupName, plugins]) => <div key={groupName} className=\"my-2\">\n      <h2 className=\"ps-2\">{groupName}</h2>\n      <div className=\"list-group my-2\">\n      {plugins.map(({ id, name, Preview }) => <button type=\"button\" key={id} onClick={(e) => {e.preventDefault(); onSelectPlugin(id)}} className=\"list-group-item list-group-item-action\">\n        <div className=\"fw-bold\">{name}</div>\n        <div><Preview saveData={saveData} /></div>\n      </button>)}\n      </div>\n    </div>)}\n  </div>\n}\n","import { useCallback, useMemo } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\nimport { allPlugins } from \"./allPlugins\";\nimport { deepCopy } from \"./deepCopy\";\n\nexport function PluginShow({ saveData, pluginId, onClose, onSubmit }: { saveData: DemoSave, pluginId: string, onClose: () => void; onSubmit: (save: DemoSave) => void }) {\n  const {Editor, read, write} = useMemo(() => allPlugins.find(_ => _.id === pluginId), [pluginId])!;\n\n  const data = useMemo(() => read(deepCopy(saveData)), [read, saveData]);\n\n  const onSubmitData = useCallback((newData: unknown) => {\n    onSubmit(deepCopy(write(saveData, newData)));\n  }, [write, saveData, onSubmit]);\n\n  return <Editor initialData={data} onClose={onClose} onSubmit={onSubmitData} />;\n}\n","import { useCallback, useState } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\nimport { Navbar } from \"./Navbar\";\nimport { PluginIndex } from \"./PluginIndex\";\nimport { PluginShow } from \"./PluginShow\";\n\nexport function SaveEditor({ saveData, onSubmit }: { saveData: DemoSave, onSubmit: (saveData: DemoSave|null) => void }) {\n  const [pluginId, setPluginId] = useState<null|string>(null);\n\n  const onSubmitPlugin = useCallback((saveData: DemoSave) => {\n    onSubmit(saveData);\n    setPluginId(null);\n  }, [onSubmit]);\n\n  const onHome = useCallback(() => {\n    if (pluginId) {\n      if (window.confirm(\"Discard changes in this form? Earlier changes will not be discarded.\")) {\n        setPluginId(null);\n      }\n    } else if (window.confirm(\"Close this save file?\")) {\n      onSubmit(null);\n    }\n  }, [pluginId, onSubmit]);\n\n  return <>\n    <Navbar onHome={onHome} />\n    {pluginId === null\n      ? <PluginIndex saveData={saveData} onSelectPlugin={setPluginId} />\n      : <PluginShow saveData={saveData} pluginId={pluginId} onClose={() => setPluginId(null)} onSubmit={onSubmitPlugin} />}\n  </>;\n}\n","import { useState } from 'react';\nimport './App.css';\nimport { DemoSave } from './DemoSave';\nimport { LoadSaveCard } from './LoadSaveCard';\nimport { Navbar } from './Navbar';\nimport { SaveContext } from './SaveContext';\nimport { SaveEditor } from './SaveEditor';\n\nfunction App() {\n  const [ saveData, setSaveData ] = useState<DemoSave|null>(null);\n\n  return <>\n    {saveData === null\n      ? <>\n        <Navbar onHome={() => { /* do nothing */ }} />\n        <LoadSaveCard onSaveLoaded={setSaveData} />\n      </>\n      : <SaveContext.Provider value={{saveData}}>\n        <SaveEditor saveData={saveData} onSubmit={setSaveData} />\n      </SaveContext.Provider>}\n  </>;\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}