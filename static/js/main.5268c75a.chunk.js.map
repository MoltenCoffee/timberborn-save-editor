{"version":3,"sources":["deepCopy.ts","LoadSaveCard.tsx","Navbar.tsx","util/UUID.ts","SaveContext.ts","BeaverUtil.ts","plugins/BeaverCopier.tsx","plugins/DownloadPlugin.tsx","plugins/MapPlugin.tsx","plugins/MapSizePlugin.tsx","plugins/PropertiesPlugin.tsx","StockpileUtil.ts","plugins/StockpilePlugin.tsx","allPlugins.ts","PluginIndex.tsx","PluginShow.tsx","SaveEditor.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["deepCopy","obj","JSON","parse","stringify","exampleDemoPlains256x256","require","exampleDemoCanyon128x128","exmapleDemoLetsPlay","LoadSaveCard","onSaveLoaded","useState","error","setError","onInput","useCallback","event","fileList","target","files","file","item","Error","reader","FileReader","onload","_event","data","result","__originalFilename","name","readAsText","loadExample","filename","className","type","accept","onClick","e","Navbar","saveData","onHome","href","preventDefault","SaveContext","createContext","undefined","lut","i","toString","BeaverUtil","setAge","beaver","age","dayNumber","Singletons","DayNightCycle","DayNumber","Components","Beaver","DayOfBirth","Math","floor","setDefaultNeeds","MortalNeeder","DeathDays","NeedManager","Needs","need","includes","Name","Points","setDefaultName","names","NameService","Names","sample","reset","Id","d0","random","d1","d2","d3","UUID","Object","assign","BehaviorManager","RunningBehaviorId","RunningBehaviorOwner","ReturnToBehavior","TimestampedBehaviorLog","Dweller","Worker","BeaverCopier","id","group","position","enabled","read","write","Preview","BeaverStatus","entities","Entities","Editor","initialData","onClose","onSubmit","filter","_","TemplateName","beavers","setBeavers","page","setPage","pageSize","setPageSize","targetAmount","setTargetAmount","sortedBeavers","sortBy","slice","offset","copyBeaver","newBeaver","duplicate","concat","doSubmit","hasNextPage","length","doSetBeaverCount","adults","newBeavers","push","style","fontWeight","map","round","Position","X","Y","Z","colSpan","min","htmlFor","value","onChange","parseInt","width","Number","MAX_SAFE_INTEGER","disabled","reduce","acc","entity","adultCount","childCount","sum","DownloadPlugin","Infinity","blob","useMemo","Blob","url","URL","createObjectURL","now","Date","replace","toISOString","substr","getHours","getMinutes","setFilename","download","endsWith","SSAO","_SSAO","BlendFunction","BufferGeometryUtils","MapPlugin","mapSizeX","MapSize","Size","mapSizeY","camera","blendFunction","MULTIPLY","samples","radius","intensity","scale","SlowBoxesHeightMap","SlowBoxesWaterMap","TreesMap","PathsMap","BeaversMap","MapControls","lodash","toJSON","isHover","setIsHover","pos","isAdult","x","y","z","onPointerEnter","onPointerLeave","console","log","color","args","createTreeGeom","dry","dead","adult","ConeBufferGeometry","translate","meshWithColorFromGeoms","geometries","geom","mergeBufferGeometries","mat","MeshStandardMaterial","Mesh","paths","PlaneBufferGeometry","rotateX","PI","BlockObject","Coordinates","object","trees","WateredObject","IsDry","LivingNaturalResource","IsDead","Growable","GrowthProgress","greenTrees","brownTrees","mesh","heights","TerrainMap","Heights","Array","split","geoms","WaterMap","WaterDepths","parseFloat","compact","wetLevels","SoilMoistureSimulator","MoistureLevels","allBoxes","BoxGeometry","wetBoxes","dryBoxes","wetLand","dryLand","MapSizePlugin","setData","fields","label","path","PropertiesPlugin","get","fromJS","toJS","getIn","setIn","stockpileTypes","capacity","stockpileIds","StockpileUtil","stockpile","find","accumulator","Storage","Goods","Good","Amount","StockpilePlugin","save","stockpiles","allGoods","StockpileInventoryTable","counts","stockpileId","setStockpileId","setStockpiles","setStockpile","mappedStockpiles","mapValues","groupBy","arr","StockpileForm","StockpileButton","goods","GoodDesirer","DesiredGoods","setCounts","nativeEvent","submitter","getAttribute","toPairs","v","setCount","good","count","totalCounts","values","whiteSpace","valueAsNumber","chunk","index","fill","allPlugins","pluginsImport","PluginIndex","onSelectPlugin","groupedPlugins","groupName","plugins","PluginShow","pluginId","onSubmitData","newData","SaveEditor","setPluginId","onSubmitPlugin","window","confirm","App","setSaveData","Provider","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5268c75a.chunk.js","sourcesContent":["/**\n * A dirty way to create a deep-copy of a save. The deep copy is usually created\n * to prevent the original copy from being edited or to force a re-render when\n * one of its deep objects might have been updated.\n * @param save\n * @returns\n */\nexport function deepCopy<T>(obj: T): T {\n  return JSON.parse(JSON.stringify(obj));\n}\n","import { FormEvent, useCallback, useState } from \"react\";\nimport { deepCopy } from \"./deepCopy\";\nimport { DemoSave } from \"./DemoSave\";\n\nconst exampleDemoPlains256x256 = require(\"./examples/demo-plains-256x256.json\");\nconst exampleDemoCanyon128x128 = require(\"./examples/demo-canyon-128x128.json\");\nconst exmapleDemoLetsPlay = require(\"./examples/demo-lets-play.json\");\n\nexport function LoadSaveCard({ onSaveLoaded }: { onSaveLoaded: (save: DemoSave) => void }) {\n  const [ error, setError ] = useState<unknown>();\n\n  const onInput = useCallback((event: FormEvent<HTMLInputElement>) => {\n    try {\n      const fileList = (event.target as HTMLInputElement|null)?.files;\n      const file = fileList?.item(0);\n      if (!file) {\n        throw new Error(`Expected file to be uploaded, found none`);\n      }\n      const reader = new FileReader();\n      reader.onload = (_event) => {\n        try {\n          const data = JSON.parse(reader.result as string);\n          data.__originalFilename = file.name;\n          onSaveLoaded(data);\n        } catch (error) {\n          setError(error);\n          throw error;\n        }\n      }\n      reader.readAsText(file, \"utf-8\");\n    } catch (error) {\n      setError(error);\n      throw error;\n    }\n  }, [onSaveLoaded, setError]);\n\n  const loadExample = useCallback((filename: string, data: DemoSave) => {\n    data.__originalFilename = filename;\n    onSaveLoaded(deepCopy(data));\n  }, [onSaveLoaded]);\n\n  return <div className=\"container my-4\">\n    <div className=\"row\">\n      <div className=\"col-md-6 offset-md-3\">\n        <label className=\"card\">\n          <div className=\"card-body\">\n            <h1 className=\"card-title\">Timberborn Save Editor</h1>\n            <div className=\"mb-3\">\n              <span className=\"form-label\">Upload your <b>Demo save</b> to start</span>\n              <input type=\"file\" name=\"save\" accept=\".json\" onInput={onInput} className=\"form-control\" />\n              {error\n                ? <small className=\"form-text\">{`#{error}`}</small>\n                : <small className=\"form-text\">Default directory: <code>%USERPROFILE%\\Documents\\Timberborn\\DemoSaves\\</code></small>}\n            </div>\n            <hr />\n            <small className=\"form-text\">Or load an example save</small>\n            <br />\n            <button className=\"btn btn-link\" onClick={(e) => loadExample(\"demo-plains-256x256.json\", exampleDemoPlains256x256)}>Demo Plains 256x256</button>\n            <button className=\"btn btn-link\" onClick={(e) => loadExample(\"demo-canyon-128x128.json\", exampleDemoCanyon128x128)}>Demo Canyon 128x128</button>\n            <button className=\"btn btn-link\" onClick={(e) => loadExample(\"demo-lets-play-256x256.json\", exmapleDemoLetsPlay)}>Lets Play 256x256</button>\n          </div>\n        </label>\n      </div>\n    </div>\n  </div>\n}\n","import { DemoSave } from \"./DemoSave\";\n\nexport function Navbar({ saveData, onHome }: { saveData?: DemoSave, onHome: () => void }) {\n  return <nav className=\"navbar navbar-light bg-light\">\n    <div className=\"container\">\n    {// eslint-disable-next-line\n    }<a href=\"#\" onClick={(e) => { e.preventDefault(); onHome(); }} className=\"navbar-brand\">Timberborn Save Editor</a>\n    </div>\n  </nav>\n}\n","/*eslint-disable*/\n\n/**\n * Fast UUID generator, RFC4122 version 4 compliant.\n * @author Jeff Ward (jcward.com).\n * @license MIT license\n * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\n **/\n\nconst lut: string[] = [];\nfor (var i=0; i<256; i++) { lut[i] = (i<16?'0':'')+(i).toString(16); }\n\nexport function UUID() {\n  var d0 = Math.random()*0xffffffff|0;\n  var d1 = Math.random()*0xffffffff|0;\n  var d2 = Math.random()*0xffffffff|0;\n  var d3 = Math.random()*0xffffffff|0;\n  return lut[d0&0xff]+lut[d0>>8&0xff]+lut[d0>>16&0xff]+lut[d0>>24&0xff]+'-'+\n    lut[d1&0xff]+lut[d1>>8&0xff]+'-'+lut[d1>>16&0x0f|0x40]+lut[d1>>24&0xff]+'-'+\n    lut[d2&0x3f|0x80]+lut[d2>>8&0xff]+'-'+lut[d2>>16&0xff]+lut[d2>>24&0xff]+\n    lut[d3&0xff]+lut[d3>>8&0xff]+lut[d3>>16&0xff]+lut[d3>>24&0xff];\n}\n","import { createContext } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\n\nexport const SaveContext = createContext<{ saveData: DemoSave }>(undefined as any);\n","import { sample } from \"lodash\";\nimport { DemoSave, UnknownEntity } from \"./DemoSave\";\nimport { UUID } from \"./util/UUID\";\n\nexport const BeaverUtil = {\n  setAge(saveData: DemoSave, beaver: UnknownEntity, age: number) {\n    const dayNumber = saveData.Singletons.DayNightCycle.DayNumber;\n    (beaver.Components.Beaver as any).DayOfBirth = Math.floor(dayNumber - age);\n  },\n\n  /**\n   * Set the default needs for a beaver\n   * @param beaver\n   */\n  setDefaultNeeds(beaver: UnknownEntity): void {\n    beaver.Components.MortalNeeder = { DeathDays: [] };\n    for (const need of (beaver.Components.NeedManager as any).Needs) {\n      if ([\"Hunger\", \"Thirst\", \"Sleep\"].includes(need.Name)) {\n        need.Points = 1.0;\n      }\n    }\n  },\n\n  setDefaultName(saveData: DemoSave, beaver: UnknownEntity): void {\n    const names = saveData.Singletons.NameService.Names;\n    (beaver.Components.Beaver as any).Name = sample(names);\n  },\n\n  reset(beaver: UnknownEntity) {\n    beaver.Id = UUID();\n    BeaverUtil.setDefaultNeeds(beaver);\n    Object.assign(beaver.Components, {\n      BehaviorManager: {\n        RunningBehaviorId: \"HomelessRootBehavior\",\n        RunningBehaviorOwner: beaver.Id,\n        ReturnToBehavior: false,\n        TimestampedBehaviorLog: [\n          \"HomelessRootBehavior 1.00\"\n        ]\n      },\n      Dweller: {},\n      Worker: {},\n    });\n  }\n}\n","import { sample, sortBy } from \"lodash\";\nimport { useCallback, useState } from \"react\";\nimport { BeaverUtil } from \"../BeaverUtil\";\nimport { deepCopy } from \"../deepCopy\";\nimport { DemoSave, DemoSaveEntity, UnknownEntity } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\nexport const BeaverCopier: IEditorPlugin<DemoSave, DemoSave> = {\n  id: \"BeaverCopier\",\n  name: \"Beaver copier\",\n  group: \"Beavers\",\n  position: 1,\n  enabled: true,\n\n  read(saveData) {\n    return saveData;\n  },\n\n  write(saveData, data) {\n    return data;\n  },\n\n  Preview({ saveData }) {\n    return <BeaverStatus entities={saveData.Entities} />;\n  },\n\n  Editor({ initialData, onClose, onSubmit }) {\n    const [ beavers, setBeavers ] = useState(() => initialData.Entities.filter(_ => _.TemplateName === \"BeaverChild\" || _.TemplateName === \"BeaverAdult\"))\n    const [ page, setPage ] = useState(0);\n    const [ pageSize, setPageSize ] = useState(10);\n    const [ targetAmount, setTargetAmount ] = useState(70);\n\n    const sortedBeavers = sortBy(beavers.slice(), _ => -(_ as any).Components.Beaver.DayOfBirth);\n\n    const offset = page * pageSize;\n\n    const copyBeaver = useCallback((beaver: UnknownEntity) => {\n      const newBeaver = deepCopy(beaver);\n      BeaverUtil.reset(newBeaver);\n      BeaverUtil.setDefaultName(initialData, newBeaver);\n      if (newBeaver.TemplateName === \"BeaverAdult\") {\n        BeaverUtil.setAge(initialData, beaver, 5)\n      }\n      return newBeaver;\n    }, [initialData]);\n\n    const duplicate = useCallback((beaver: UnknownEntity) => {\n      setBeavers(beavers.slice().concat([copyBeaver(beaver)]));\n    }, [beavers, setBeavers, copyBeaver]);\n\n    const doSubmit = useCallback(() => {\n      const Entities = initialData.Entities\n        .filter(_ => _.TemplateName !== \"BeaverChild\" && _.TemplateName !== \"BeaverAdult\")\n        .concat(beavers);\n\n      onSubmit({ ...initialData, Entities });\n    }, [onSubmit, beavers, initialData]);\n\n    const hasNextPage = pageSize + offset < beavers.length;\n\n    const doSetBeaverCount = useCallback(() => {\n      const adults = beavers.filter(_ => _.TemplateName === \"BeaverAdult\");\n      const newBeavers = beavers.slice();\n      for (const beaver of newBeavers) {\n        BeaverUtil.setDefaultNeeds(beaver);\n      }\n      while (newBeavers.length < targetAmount) {\n        newBeavers.push(copyBeaver(sample(adults)!));\n      }\n      setBeavers(newBeavers);\n    }, [beavers, targetAmount, copyBeaver]);\n\n    return <div className=\"container my-4\">\n      <div className=\"card\">\n        <div className=\"card-body\">\n          <h1 className=\"card-title\">Beaver Copier</h1>\n          <div className=\"d-flex\">\n            <div>\n              <BeaverStatus entities={beavers} />\n            </div>\n            <div className=\"ms-auto\">\n              <button type=\"button\" onClick={onClose} className=\"btn btn-light\">Discard changes</button>\n              {\" \"}\n              <button type=\"button\" onClick={doSubmit} className=\"btn btn-primary\">Submit</button>\n            </div>\n          </div>\n          {beavers.length > 80 ? <div className=\"alert alert-danger mt-1\">\n            <b>WARNING:</b> You have {beavers.length} beavers. Newer versions of\n            the Timberborn Demo will randomly crash with over 80 beavers.\n          </div> : null}\n        </div>\n        <table className=\"table my-0\">\n          <thead>\n            <tr>\n              <th>Name</th>\n              <th>Age <small style={{fontWeight: \"normal\"}}>a-z</small></th>\n              <th>Coordinates</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>\n            {sortedBeavers.slice(offset, offset + pageSize).map((beaver: any) => <tr key={beaver.Id}>\n              <td>{beaver.Components.Beaver.Name}</td>\n              <td>{initialData.Singletons.DayNightCycle.DayNumber - beaver.Components.Beaver.DayOfBirth} {beaver.TemplateName === \"BeaverChild\" ? <small>(child)</small> : null}</td>\n              <td>\n                x: <b>{Math.round(beaver.Components.Beaver.Position.X)}</b>{\" \"}\n                y: <b>{Math.round(beaver.Components.Beaver.Position.Y)}</b>{\" \"}\n                z: <b>{Math.round(beaver.Components.Beaver.Position.Z)}</b>{\" \"}\n              </td>\n              <td className=\"text-end py-1\">\n                <button type=\"button\" className=\"btn btn-light btn-sm\" onClick={() => duplicate(beaver)}>Copy</button>\n              </td>\n            </tr>)}\n          </tbody>\n          <tfoot>\n            <tr>\n              <td colSpan={4} className=\"py-1\">\n                <div className=\"d-flex\">\n                  <div className=\"me-auto\">\n                    Showing <strong>{offset}</strong> - <strong>{Math.min(beavers.length, offset + pageSize)}</strong> of <strong>{beavers.length}</strong>\n                  </div>\n                  <form className=\"me-3 d-flex\" onSubmit={(event) => { event.preventDefault(); doSetBeaverCount(); }}>\n                    <label className=\"form-label me-1 mt-1 mb-0\" htmlFor=\"addRandom\">Set beavers</label>\n                    <input type=\"number\" id=\"addRandom\" className=\"form-control form-control-sm\" value={targetAmount}\n                      onChange={(event) => { setTargetAmount(parseInt(event.target.value, 10)) }} width={3} style={{width: 60}} />\n                    <button type=\"submit\" className=\"ms-1 btn btn-primary btn-sm\">Set</button>\n                  </form>\n                  <div className=\"me-3 d-flex\">\n                    <label className=\"form-label me-1 mt-1 mb-0\" htmlFor=\"pageSize\">Pagesize</label>\n                    <select id=\"pageSize\" className=\"form-control form-control-sm\" value={pageSize} onChange={(event) => { setPage(0); setPageSize(parseInt(event.target.value, 10)) }}>\n                      <option>10</option>\n                      <option>25</option>\n                      <option>100</option>\n                      <option>250</option>\n                      <option>1000</option>\n                      <option value={`${Number.MAX_SAFE_INTEGER}`}>ALL</option>\n                    </select>\n                  </div>\n                  <div>\n                    <button className=\"btn btn-sm btn-light\" disabled={page<=0} onClick={() => setPage(page-1)}>&lsaquo; prev</button>\n                    {\" \"}\n                    <button className=\"btn btn-sm btn-light\" disabled={!hasNextPage} onClick={() => setPage(page+1)}>next &rsaquo;</button>\n                  </div>\n                </div>\n              </td>\n            </tr>\n          </tfoot>\n        </table>\n      </div>\n    </div>;\n  }\n}\n\nfunction BeaverStatus({entities}: {entities: DemoSaveEntity[]}) {\n  const {adultCount, childCount} = entities.reduce((acc, entity) => {\n    if (entity.TemplateName === \"BeaverAdult\") {\n      acc.adultCount++;\n    }\n    if (entity.TemplateName === \"BeaverChild\") {\n      acc.childCount++;\n    }\n    return acc;\n  }, { adultCount: 0, childCount: 0 })\n\n  const sum = adultCount+childCount;\n\n  return <span>You have <strong>{sum}</strong> beavers: <strong>{childCount}</strong> kits and <strong>{adultCount}</strong> adults.</span>;\n\n}\n","import { useMemo, useState } from \"react\";\nimport { DemoSave } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\nexport const DownloadPlugin: IEditorPlugin<DemoSave, DemoSave> = {\n  id: \"DownloadPlugin\",\n  name: \"Download\",\n  group: \"General\",\n  position: -Infinity,\n  enabled: true,\n\n  read(saveData) {\n    return saveData;\n  },\n\n  write(saveData, data) {\n    throw new Error(`Not implemented`);\n  },\n\n  Preview({ saveData }) {\n    return null;\n  },\n\n  Editor({ initialData, onClose }) {\n    const blob = useMemo(() => new Blob([JSON.stringify(initialData, null, 2)], {type: 'application/json'}), [initialData]);\n    const url = URL.createObjectURL(blob);\n\n\n    const [filename, setFilename] = useState<string>(() => {\n      const now = new Date();\n      return `${initialData.__originalFilename.replace(\".json\", \"\")} MODDED ${now.toISOString().substr(0, 10)} ${now.getHours()}h${now.getMinutes()}m.json`;\n    });\n\n    return <div className=\"container\">\n      <div className=\"card my-4\">\n        <div className=\"card-body\">\n          <h1 className=\"card-title\">Download</h1>\n          <div className=\"my-3\">\n            <label htmlFor=\"filename\" className=\"form-label\">Filename</label>\n            <input type=\"text\" value={filename} onChange={(e) => setFilename(e.target.value)} id=\"filename\" className=\"form-control\" />\n          </div>\n          <div className=\"d-flex\">\n            <a href={url} download={filename.endsWith(\".json\") ? filename : filename + \".json\"} className=\"btn btn-primary\" onClick={() => onClose()}>Download</a>\n            <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Close</button>\n          </div>\n        </div>\n      </div>\n    </div>;\n  }\n}\n","import { DemoSave, UnknownEntity } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\nimport { Canvas } from '@react-three/fiber'\nimport { useMemo, useState } from \"react\";\nimport lodash from \"lodash\";\nimport { MapControls } from \"@react-three/drei\";\nimport './MapPlugin.scss';\nimport { Navbar } from \"../Navbar\";\nimport { BoxGeometry, ConeBufferGeometry, Mesh, MeshStandardMaterial, PlaneBufferGeometry } from \"three\";\nimport { EffectComposer, SSAO as _SSAO } from \"@react-three/postprocessing\";\n\nconst SSAO = _SSAO as any;\nconst { BlendFunction } = require(\"postprocessing\") as any;\nconst BufferGeometryUtils = require('three/examples/jsm/utils/BufferGeometryUtils.js') as any;\n\nexport const MapPlugin: IEditorPlugin<DemoSave, DemoSave> = {\n  id: \"MapPlugin\",\n  name: \"Map\",\n  position: 2,\n  group: \"General\",\n  enabled: true,\n\n  read: (saveData) => saveData,\n  write: (saveData, data) => data,\n\n  Preview: ({ saveData }) => <div>\n    A 3D Map\n  </div>,\n\n  Editor: ({ initialData, onSubmit, onClose }) => {\n\n    // X: Left/Right\n    // Y: Up (+), Down (-)\n    // Z: Front (+), Far (-)\n\n    const {Singletons} = initialData;\n    const mapSizeX = Singletons.MapSize.Size.X;\n    const mapSizeY = Singletons.MapSize.Size.Y;\n\n    return <div className=\"Map__Editor\">\n      <Navbar onHome={onClose} />\n\n      <Canvas camera={{position: [32, 64, -64]}}>\n        <EffectComposer>\n          <SSAO\n            blendFunction={BlendFunction.MULTIPLY}\n            samples={50}\n            radius={2}\n            intensity={30}\n          />\n        </EffectComposer>\n        <axesHelper position={[0, 8, 0]} scale={[4, 4, 4]} />\n        <ambientLight intensity={0.3} />\n        <directionalLight position={[10, 10, 10]} intensity={0.4} />\n        <group scale={[1, 1, -1]}>\n          <group position={[mapSizeX/-2, 0, mapSizeY/-2]}>\n            <SlowBoxesHeightMap initialData={initialData} />\n            <SlowBoxesWaterMap initialData={initialData} />\n            <TreesMap initialData={initialData} />\n            <PathsMap initialData={initialData} />\n            <BeaversMap initialData={initialData} />\n          </group>\n        </group>\n        <MapControls />\n      </Canvas>\n    </div>;\n  }\n}\n\nfunction BeaversMap({ initialData }: { initialData: DemoSave }) {\n  const beavers = useMemo(() => lodash(initialData.Entities)\n    .filter((_) => [\"BeaverAdult\", \"BeaverChild\"].includes(_.TemplateName)).toJSON(), [initialData.Entities]);\n\n  return <group>\n    {beavers.map((beaver: UnknownEntity) => <Beaver key={beaver.Id} beaver={beaver} />)}\n  </group>;\n}\n\nfunction Beaver({ beaver }: { beaver: UnknownEntity }) {\n  const [isHover, setIsHover] = useState(false);\n\n  const onClick = () => {\n    console.log(beaver);\n  }\n\n  const onPointerEnter = () => {\n    setIsHover(true);\n  }\n\n  const onPointerLeave = () => {\n    setIsHover(false);\n  }\n\n  const pos = (beaver.Components as any).Beaver.Position;\n  const isAdult = beaver.TemplateName === \"BeaverAdult\";\n  const x: number = pos.X;\n  const y: number = pos.Y + 0.1 + (isAdult ? 0.5 : 0.3);\n  const z: number = pos.Z;\n  return <mesh onPointerEnter={onPointerEnter} onPointerLeave={onPointerLeave} onClick={onClick} key={beaver.Id} position={[x, y, z]}>\n    <meshStandardMaterial color={isHover ? \"#FF8A65\" : \"#E64A19\"} />\n    <cylinderBufferGeometry args={[\n      isHover ? 0.6 : 0.4,\n      isHover ? 0.6 : 0.4,\n      (beaver.TemplateName === \"BeaverAdult\" ? 1.0 : 0.6) * (isHover ? 1.2 : 1.0),\n      8.0,\n      1.0,\n    ]} />\n  </mesh>;\n}\n\nfunction createTreeGeom({ dry, dead, adult, x, y, z }: {\n  entity: any;\n  dry: boolean;\n  dead: boolean;\n  adult: boolean;\n  x: number;\n  z: number;\n  y: number;\n}) {\n  return new ConeBufferGeometry((adult ? 0.4 : 0.2) * (dead ? 0.5 : 1.0), adult ? 2.0 : 0.5, 4.0, 4.0)\n    .translate(x, y + 0.5, z)\n}\n\nfunction meshWithColorFromGeoms(geometries: any[], color: string) {\n  const geom = BufferGeometryUtils.mergeBufferGeometries(geometries)\n  const mat = new MeshStandardMaterial({ color });\n  return new Mesh(geom, mat);\n}\n\nfunction PathsMap({ initialData }: { initialData: DemoSave }) {\n  const paths = useMemo(() => {\n    const paths = lodash(initialData.Entities)\n      .filter((_) => [\"DirtPath\"].includes(_.TemplateName))\n      .map((_: any) => new PlaneBufferGeometry(1, 1, 1, 1)\n        .rotateX(-Math.PI/2)\n        .translate(\n          _.Components.BlockObject.Coordinates.X,\n          _.Components.BlockObject.Coordinates.Z + 0.1,\n          _.Components.BlockObject.Coordinates.Y\n        ),\n      );\n\n    return meshWithColorFromGeoms(paths.toJSON(), \"#BCAAA4\");\n  }, [initialData.Entities]);\n\n  return <primitive object={paths} />;\n}\n\nfunction TreesMap({ initialData }: { initialData: DemoSave }) {\n  const {greenTrees, brownTrees} = useMemo(() => {\n    const trees = lodash(initialData.Entities)\n      .filter((_) => [\"Maple\", \"Pine\"].includes(_.TemplateName))\n      .map((_: any) => ({\n        entity: _,\n        dry: _.Components.WateredObject.IsDry as boolean,\n        dead: _.Components.LivingNaturalResource.IsDead as boolean,\n        adult: _.Components.Growable.GrowthProgress > 0.9999,\n        x: _.Components.BlockObject.Coordinates.X as number,\n        z: _.Components.BlockObject.Coordinates.Y as number,\n        y: _.Components.BlockObject.Coordinates.Z as number,\n      }));\n\n    const greenTrees = meshWithColorFromGeoms(\n      trees.filter(_ => !(_.dry || _.dead)).map(createTreeGeom).toJSON(), \"#388E3C\");\n    const brownTrees = meshWithColorFromGeoms(\n      trees.filter(_ => _.dry || _.dead).map(createTreeGeom).toJSON(), \"#5D4037\");\n\n    return {greenTrees, brownTrees}\n  }, [initialData.Entities]);\n\n  return <group>\n    <primitive object={greenTrees} />\n    <primitive object={brownTrees} />\n  </group>;\n}\n\nfunction SlowBoxesWaterMap({initialData}: {initialData: DemoSave}) {\n  const {Singletons} = initialData;\n  const mesh = useMemo(() => {\n    const mapSizeY = Singletons.MapSize.Size.Y;\n\n    const heights = Singletons.TerrainMap.Heights.Array.split(\" \").map(_ => parseInt(_, 10));\n\n    const geoms = lodash(Singletons.WaterMap.WaterDepths.Array)\n      .split(\" \")\n      .map((y) => parseFloat(y))\n      .map((y, i) => y > 0 ? y + heights[i] : 0)\n      .map((y, i) => y > 0 ? ({ x: i % mapSizeY, y, z: Math.floor(i / mapSizeY) }) : null)\n      .compact()\n      .map(({ x, y, z}) => new PlaneBufferGeometry(1, 1, 1, 1).rotateX(-Math.PI/2).translate(x, y, z))\n      .toJSON()\n\n    const geom = BufferGeometryUtils.mergeBufferGeometries(geoms)\n    const mat = new MeshStandardMaterial({ color: \"#0044cc\" });\n    return new Mesh(geom, mat);\n  }, [Singletons.TerrainMap.Heights.Array, Singletons.WaterMap.WaterDepths.Array, Singletons.MapSize.Size.Y])\n\n  return <primitive object={mesh} />;\n}\n\nfunction SlowBoxesHeightMap({initialData}: {initialData: DemoSave}) {\n  const {Singletons} = initialData;\n\n  const {wetLand, dryLand} = useMemo(() => {\n    const mapSizeY = Singletons.MapSize.Size.Y;\n    const wetLevels = Singletons.SoilMoistureSimulator.MoistureLevels.Array.split(\" \").map(_ => parseFloat(_));\n\n    const allBoxes = lodash(Singletons.TerrainMap.Heights.Array)\n      .split(\" \")\n      .map(_ => parseInt(_, 10))\n      .map((y, i) => ({ x: i % mapSizeY, y, z: Math.floor(i / mapSizeY) }))\n      .map(({ x, y, z}) => new BoxGeometry(1, y, 1, 1, 1, 1).translate(x, y / 2, z));\n\n    const wetBoxes = allBoxes.filter((_, i) => wetLevels[i] > 0).toJSON();\n    const dryBoxes = allBoxes.filter((_, i) => wetLevels[i] === 0).toJSON();\n\n    return {\n      wetLand: meshWithColorFromGeoms(wetBoxes, \"#8BC34A\"),\n      dryLand: meshWithColorFromGeoms(dryBoxes, \"#795548\")\n    }\n  }, [Singletons.TerrainMap.Heights.Array, Singletons.MapSize.Size.Y, Singletons.SoilMoistureSimulator.MoistureLevels.Array])\n\n  return <group>\n    <primitive object={wetLand} />\n    <primitive object={dryLand} />\n  </group>;\n}\n","import { useState } from \"react\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\ninterface MapSizeParams {\n  x: number;\n  y: number;\n}\n\nexport const MapSizePlugin: IEditorPlugin<MapSizeParams, MapSizeParams> = {\n  id: \"MapSizePlugin\",\n  name: \"Map size\",\n  group: \"General\",\n  position: Infinity,\n  enabled: true,\n\n  read(saveData) {\n    const x = saveData.Singletons.MapSize.Size.X;\n    const y = saveData.Singletons.MapSize.Size.Y;\n    return { x, y };\n  },\n\n  write(saveData, data) {\n    saveData.Singletons.MapSize.Size.X = data.x;\n    saveData.Singletons.MapSize.Size.Y = data.y;\n    return saveData;\n  },\n\n  Preview({ saveData }) {\n    const x = saveData.Singletons.MapSize.Size.X;\n    const y = saveData.Singletons.MapSize.Size.Y;\n    return <span>\n      <strong>{x}</strong> &times; <strong>{y}</strong>\n    </span>;\n  },\n\n  Editor({ initialData, onClose, onSubmit }) {\n    const [data, setData] = useState(initialData);\n\n    return <form onSubmit={(e) => { e.preventDefault(); onSubmit(data); }}>\n      <div className=\"container\">\n        <div className=\"card my-4\">\n          <div className=\"card-body\">\n            <h1 className=\"card-title\">Map size editor</h1>\n            <p>This is just a demo editor - changing this will likely break something.</p>\n            <div className=\"mb-3\">\n              <label htmlFor=\"x\" className=\"form-label\">X</label>\n              <input id=\"x\" type=\"number\" className=\"form-control\" value={data.x} onInput={(e) => setData({ ...data, x: parseInt((e.target as HTMLInputElement).value, 10) })} />\n            </div>\n            <div className=\"mb-3\">\n              <label htmlFor=\"y\" className=\"form-label\">Y</label>\n              <input id=\"y\" type=\"number\" className=\"form-control\" value={data.y} onInput={(e) => setData({ ...data, y: parseInt((e.target as HTMLInputElement).value, 10) })} />\n            </div>\n            <div className=\"d-flex\">\n              <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\n              <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Discard changes</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </form>;\n  }\n}\n","import { fromJS, Map } from \"immutable\";\nimport { get } from \"lodash\";\nimport { useState } from \"react\";\nimport { DemoSave } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\n\ntype Singletons = DemoSave[\"Singletons\"];\n\nconst fields = [{\n  label: \"Science\",\n  path: [\"ScienceService\", \"SciencePoints\"],\n  type: \"number\",\n  parse: (value: string) => parseInt(value, 10),\n  id: \"science-points\",\n}, {\n  label: \"Cycle\",\n  path: [\"CycleService\", \"Cycle\"],\n  type: \"number\",\n  parse: (value: string) => parseInt(value, 10),\n  id: \"cycle\",\n}, {\n  label: \"Cycle Day\",\n  path: [\"CycleService\", \"CycleDay\"],\n  type: \"number\",\n  parse: (value: string) => parseInt(value, 10),\n  id: \"cycle-day\",\n}, {\n  label: \"Wet season duration\",\n  path: [\"CycleService\", \"WetSeasonDuration\"],\n  type: \"number\",\n  parse: (value: string) => parseInt(value, 10),\n  id: \"wet-season-duration\",\n}, {\n  label: \"Dry season duration\",\n  path: [\"CycleService\", \"DrySeasonDuration\"],\n  type: \"number\",\n  parse: (value: string) => parseInt(value, 10),\n  id: \"dry-season-duration\",\n}];\n\nexport const PropertiesPlugin: IEditorPlugin<Singletons, Singletons> = {\n  read: (saveData) => saveData.Singletons,\n  write: (saveData, data) => ({ ...saveData, Singletons: data }),\n  position: 0,\n  id: \"PropertiesPlugin\",\n  name: \"Properties\",\n  group: \"General\",\n  enabled: true,\n  Preview: ({ saveData }) => {\n    return <div>\n      {fields.map((_) => <div key={_.id}>{_.label}: <strong>{get(saveData.Singletons, _.path)}</strong></div>)}\n    </div>;\n  },\n  Editor: ({ initialData, onClose, onSubmit }) => {\n    const [data, setData] = useState(fromJS(initialData) as Map<string, any>);\n\n    return <form onSubmit={(e) => { e.preventDefault(); onSubmit(data.toJS() as Singletons); }}>\n      <div className=\"container\">\n        <div className=\"card my-4\">\n          <div className=\"card-body\">\n            <h1 className=\"card-title\">Properties</h1>\n            {fields.map(({ path, type, parse, id, label }) => <div key={id} className=\"mb-3\">\n              <label htmlFor={id} className=\"form-label\">{label}</label>\n              <input id={id} type={type} className=\"form-control\"\n                value={data.getIn(path) as string}\n                onInput={(e) => setData(data.setIn(path, parse((e.target as HTMLInputElement).value)))} />\n            </div>)}\n            <div className=\"d-flex\">\n              <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\n              <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Discard changes</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </form>;\n  }\n}\n","import { DemoSave, UnknownEntity } from \"./DemoSave\";\n\ninterface StockpileGoodsEntry {\n  Good: { Id: string };\n  Amount: number;\n}\n\nconst stockpileTypes = [{\n  id: \"SmallWaterTank\",\n  capacity: 30\n}, {\n  id: \"SmallWarehouse\",\n  capacity: 200,\n}, {\n  id: \"LogPile\",\n  capacity: 180,\n}];\n\nconst stockpileIds = stockpileTypes.map(_ => _.id)\n\nexport const StockpileUtil = {\n  stockpileTypes,\n  getCapacity: (stockpile: UnknownEntity) => stockpileTypes.find(_ => _.id === stockpile.TemplateName)?.capacity,\n  getStockpiles: (saveData: DemoSave) => saveData.Entities.filter(_ => stockpileIds.includes(_.TemplateName)),\n  countGoods: (stockpile: UnknownEntity, accumulator = {} as Record<string, number>) => ((stockpile.Components[\"Inventory:Stockpile\"] as any).Storage.Goods as StockpileGoodsEntry[])\n    .reduce((acc, { Good, Amount }) => ({ ...acc, [Good.Id]: Amount + (acc[Good.Id] || 0) }), accumulator)\n}\n","import { assign, chunk, fill, groupBy, map, mapValues, sum, toPairs, values } from \"lodash\";\nimport { FormEvent, Fragment, useCallback, useMemo, useState } from \"react\";\nimport { DemoSave, UnknownEntity } from \"../DemoSave\";\nimport { IEditorPlugin } from \"../IEditorPlugin\";\nimport { StockpileUtil } from \"../StockpileUtil\";\n\nexport const StockpilePlugin: IEditorPlugin<DemoSave, DemoSave> = {\n  id: \"StockpilePlugin\",\n  name: \"Manage stockpile inventories\",\n  group: \"Storage\",\n  position: 10,\n  enabled: true,\n\n  read: (save) => save,\n  write: (_, data) => data,\n\n  Preview: ({ saveData }) => {\n    const stockpiles = useMemo(() => StockpileUtil.getStockpiles(saveData), [saveData]);\n    const allGoods = useMemo(() => stockpiles.reduce((acc, stockpile) => StockpileUtil.countGoods(stockpile, acc), {} as Record<string, number>), [stockpiles]);\n\n    return <div>\n      <StockpileInventoryTable counts={allGoods} />\n    </div>\n  },\n\n  Editor: ({ initialData, onClose, onSubmit }) => {\n    const [ stockpileId, setStockpileId ] = useState<string|null>(null);\n    const [ stockpiles, setStockpiles ] = useState(() => StockpileUtil.getStockpiles(initialData));\n\n    const setStockpile = useCallback((type: \"self\"|\"all\", stockpile: UnknownEntity) => {\n      setStockpiles(stockpiles.slice().map((_) => (type === \"all\" ? _.TemplateName === stockpile.TemplateName : _.Id === stockpile.Id) ? {\n        ..._,\n        Components: { ..._.Components, \"Inventory:Stockpile\": stockpile.Components[\"Inventory:Stockpile\"] }\n      } : _));\n      setStockpileId(null);\n    }, [setStockpiles, stockpiles, setStockpileId])\n\n    const doSubmit = useCallback(() => {\n      const mappedStockpiles = mapValues(groupBy(stockpiles, \"Id\"), (arr) => arr[0]);\n\n      onSubmit({\n        ...initialData,\n        Entities: initialData.Entities.map((_) => mappedStockpiles[_.Id] ? mappedStockpiles[_.Id] : _),\n      });\n    }, [onSubmit, initialData, stockpiles]);\n\n    return <div className=\"container my-4\">\n      <div className=\"card\">\n        <div className=\"card-body\">\n          <h1 className=\"card-title\">Manage stockpile inventories</h1>\n          <div className=\"d-flex\">\n            <button type=\"button\" className=\"btn btn-primary\" onClick={doSubmit}>Submit</button>\n            <button type=\"button\" className=\"btn btn-light ms-auto\" onClick={onClose}>Discard changes</button>\n          </div>\n        </div>\n        <div className=\"list-group list-group-flush\">\n          {stockpiles.map((stockpile) => stockpileId === stockpile.Id\n            ? <StockpileForm key={stockpile.Id} setStockpile={setStockpile} stockpile={stockpile} />\n            : <StockpileButton key={stockpile.Id} setStockpileId={setStockpileId} stockpile={stockpile} />)}\n        </div>\n      </div>\n    </div>;\n  }\n}\n\nfunction StockpileForm({ stockpile, setStockpile }: { stockpile: UnknownEntity, setStockpile: (type: \"self\"|\"all\", stockpile: UnknownEntity) => void }) {\n  const goods: string[] = useMemo(() => (stockpile.Components.GoodDesirer as any).DesiredGoods.map((_: any) => _.Good.Id), [stockpile]);\n  const [ counts, setCounts ] = useState(() => StockpileUtil.countGoods(stockpile));\n\n  const onSubmit = useCallback((event: FormEvent) => {\n    event.preventDefault();\n    const type = (event.nativeEvent as SubmitEvent).submitter?.getAttribute(\"value\") === \"all\" ? \"all\" : \"self\";\n    setStockpile(type, {\n      ...stockpile,\n      Components: {\n        ...stockpile.Components,\n        \"Inventory:Stockpile\": {\n          Storage: {\n            Goods: toPairs(counts).filter(([k,v]) => v && v > 0).map(([Id, Amount]) => ({ Good: {Id}, Amount }))\n          }\n        }\n      }\n    })\n  }, [stockpile, setStockpile, counts]);\n\n\n  const setCount = useCallback((good: string, count: number) => {\n    setCounts({ ...counts, [good]: count });\n  }, [setCounts, counts]);\n\n  const totalCounts = sum(map(values(counts), _ => _ || 0));\n  const capacity = StockpileUtil.getCapacity(stockpile) ?? 0;\n\n  return <div className=\"list-group-item\">\n    <div className=\"d-flex\">\n      <div>\n        <b>{stockpile.TemplateName}</b>\n        <div style={{whiteSpace: \"nowrap\"}}>\n          x: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.X)}</b>{\" \"}\n          y: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Y)}</b>{\" \"}\n          z: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Z)}</b>{\" \"}\n        </div>\n      </div>\n      <form className=\"flex-fill\" onSubmit={onSubmit}>\n        {goods.map((good) => <div key={good} className=\"row mb-3\">\n          <label className=\"col-sm-2 col-form-label col-form-label-sm text-end\">{good}</label>\n          <div className=\"col-sm-10\">\n            <input className=\"form-control form-control-sm\" type=\"number\"\n              onChange={(event) => { setCount(good, event.target.valueAsNumber ?? 0) }} value={counts[good] || \"\"} />\n          </div>\n        </div>)}\n        <div className=\"row\">\n          <div className=\"col-sm-10 offset-sm-2 d-flex\">\n            <button type=\"submit\" name=\"submit\" value=\"self\" className=\"btn btn-primary btn-sm\">OK</button>\n            {totalCounts > capacity\n              ? <div className=\"text-danger p-1\">Warning: <strong>{totalCounts}</strong> storage exceeds capacity of <strong>{capacity}</strong>!</div>\n              : <div className=\"p-1\"><strong>{totalCounts}</strong> / <strong>{capacity}</strong></div>}\n            <button type=\"submit\" name=\"submit\" value=\"all\" className=\"ms-auto btn btn-danger btn-sm\">OK &amp; update all</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n}\n\nfunction StockpileButton({ stockpile, setStockpileId }: { stockpile: UnknownEntity, setStockpileId: (id: string) => void }) {\n  return <button onClick={() => setStockpileId(stockpile.Id)} className=\"list-group-item list-group-item-action\">\n    <div className=\"d-flex\">\n      <div>\n        <b>{stockpile.TemplateName}</b>\n        <div style={{whiteSpace: \"nowrap\"}}>\n          x: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.X)}</b>{\" \"}\n          y: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Y)}</b>{\" \"}\n          z: <b>{Math.round((stockpile.Components.BlockObject as any).Coordinates.Z)}</b>{\" \"}\n        </div>\n      </div>\n      <StockpileInventoryTable counts={StockpileUtil.countGoods(stockpile)} />\n    </div>\n  </button>;\n}\n\nfunction StockpileInventoryTable({ counts }: { counts: Record<string, number> }) {\n  return <table className=\"table table-sm table-borderless my-0\">\n    <tbody>\n      {chunk(toPairs(counts), 5).map((chunk, index) => <tr key={index}>\n        {assign(fill(new Array(5), [\"\", \"\"]), chunk).map(([label, value], i) => <Fragment key={i}>\n          <th style={{width: \"17%\"}} className=\"text-end\">{label}</th>\n          <td style={{width: \"3%\"}} className=\"text-end\">{value}</td>\n        </Fragment>)}\n      </tr>)}\n    </tbody>\n  </table>;\n}\n","import { sortBy } from \"lodash\";\nimport { IEditorPlugin } from \"./IEditorPlugin\";\nimport * as pluginsImport from \"./plugins\";\n\nexport const allPlugins: IEditorPlugin<any, any>[] = sortBy(Object\n  .values(pluginsImport)\n  .filter(_ => _ && typeof _ === \"object\"), \"position\");\n","import { useMemo } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\nimport { allPlugins } from \"./allPlugins\";\nimport { groupBy, toPairs } from \"lodash\";\n\nexport function PluginIndex({ saveData, onSelectPlugin }: { saveData: DemoSave, onSelectPlugin: (pluginId: string) => void }) {\n  const groupedPlugins = useMemo(() => toPairs(groupBy(allPlugins\n    .filter(_ => typeof _.enabled === \"function\" ? _.enabled({saveData}) : _.enabled), \"group\")), [saveData]);\n\n  return <div className=\"container\">\n    {groupedPlugins.map(([groupName, plugins]) => <div key={groupName} className=\"my-2\">\n      <h2 className=\"ps-2\">{groupName}</h2>\n      <div className=\"list-group my-2\">\n      {plugins.map(({ id, name, Preview }) => <button type=\"button\" key={id} onClick={(e) => {e.preventDefault(); onSelectPlugin(id)}} className=\"list-group-item list-group-item-action\">\n        <div className=\"fw-bold\">{name}</div>\n        <div><Preview saveData={saveData} /></div>\n      </button>)}\n      </div>\n    </div>)}\n  </div>\n}\n","import { useCallback, useMemo } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\nimport { allPlugins } from \"./allPlugins\";\nimport { deepCopy } from \"./deepCopy\";\n\nexport function PluginShow({ saveData, pluginId, onClose, onSubmit }: { saveData: DemoSave, pluginId: string, onClose: () => void; onSubmit: (save: DemoSave) => void }) {\n  const {Editor, read, write} = useMemo(() => allPlugins.find(_ => _.id === pluginId), [pluginId])!;\n\n  const data = useMemo(() => read(deepCopy(saveData)), [read, saveData]);\n\n  const onSubmitData = useCallback((newData: unknown) => {\n    onSubmit(deepCopy(write(saveData, newData)));\n  }, [write, saveData, onSubmit]);\n\n  return <Editor initialData={data} onClose={onClose} onSubmit={onSubmitData} />;\n}\n","import { useCallback, useState } from \"react\";\nimport { DemoSave } from \"./DemoSave\";\nimport { Navbar } from \"./Navbar\";\nimport { PluginIndex } from \"./PluginIndex\";\nimport { PluginShow } from \"./PluginShow\";\n\nexport function SaveEditor({ saveData, onSubmit }: { saveData: DemoSave, onSubmit: (saveData: DemoSave|null) => void }) {\n  const [pluginId, setPluginId] = useState<null|string>(null);\n\n  const onSubmitPlugin = useCallback((saveData: DemoSave) => {\n    onSubmit(saveData);\n    setPluginId(null);\n  }, [onSubmit]);\n\n  const onHome = useCallback(() => {\n    if (pluginId) {\n      if (window.confirm(\"Discard changes in this form? Earlier changes will not be discarded.\")) {\n        setPluginId(null);\n      }\n    } else if (window.confirm(\"Close this save file?\")) {\n      onSubmit(null);\n    }\n  }, [pluginId, onSubmit]);\n\n  return <>\n    <Navbar onHome={onHome} />\n    {pluginId === null\n      ? <PluginIndex saveData={saveData} onSelectPlugin={setPluginId} />\n      : <PluginShow saveData={saveData} pluginId={pluginId} onClose={() => setPluginId(null)} onSubmit={onSubmitPlugin} />}\n  </>;\n}\n","import { useState } from 'react';\nimport './App.css';\nimport { DemoSave } from './DemoSave';\nimport { LoadSaveCard } from './LoadSaveCard';\nimport { Navbar } from './Navbar';\nimport { SaveContext } from './SaveContext';\nimport { SaveEditor } from './SaveEditor';\n\nfunction App() {\n  const [ saveData, setSaveData ] = useState<DemoSave|null>(null);\n\n  return <>\n    {saveData === null\n      ? <>\n        <Navbar onHome={() => { /* do nothing */ }} />\n        <LoadSaveCard onSaveLoaded={setSaveData} />\n      </>\n      : <SaveContext.Provider value={{saveData}}>\n        <SaveEditor saveData={saveData} onSubmit={setSaveData} />\n      </SaveContext.Provider>}\n  </>;\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}